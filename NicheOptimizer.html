<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamer & Niche AI Hub - COCKPIT MODE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --color-bg-dark: #0d0d0d; --color-bg-medium: #1a1a1a;
            --color-primary-pink: #ff0099; --color-secondary-blue: #22c7ef;
            --color-ai-growth: #ffcc00; --color-border-dark: #2e2e2e;
            --shadow-pink: 0 0 15px rgba(255, 0, 153, 0.4);
        }
        body { background: var(--color-bg-dark); color: #fff; font-family: 'Inter', sans-serif; }
        .tab-btn { font-family: 'Orbitron'; padding: 12px; background: #111; color: #9aa3a8; flex: 1; border-radius: 8px 8px 0 0; border: 1px solid var(--color-border-dark); border-bottom: none; }
        .tab-btn.active { background: var(--color-bg-medium); color: #fff; border-top: 3px solid var(--color-primary-pink); box-shadow: var(--shadow-pink); }
        .tab-content { display: none; background: var(--color-bg-medium); border: 1px solid var(--color-border-dark); padding: 20px; border-radius: 0 0 10px 10px; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from {opacity:0} to {opacity:1} }

        /* Notification Pop-up */
        #notification-box { position: fixed; top: 20px; right: 20px; z-index: 10000; }
        .toast { background: #222; border-left: 4px solid var(--color-primary-pink); padding: 12px 20px; margin-bottom: 10px; border-radius: 4px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); display: flex; justify-content: space-between; align-items: center; min-width: 280px; animation: slideIn 0.4s ease-out; }
        @keyframes slideIn { from { transform: translateX(110%); } to { transform: translateX(0); } }
    </style>
</head>
<body class="p-4">

<div id="notification-box"></div>

<div class="max-w-7xl mx-auto">
    <h1 class="text-3xl text-center mb-6 font-['Orbitron'] text-[#ff0099]">COCKPIT MODE V15</h1>

    <div class="flex flex-wrap">
        <button class="tab-btn active" onclick="openTab(event, 'tab-dash')">ðŸ“Š SCANNER</button>
        <button class="tab-btn" onclick="openTab(event, 'tab-gold')" style="border-top-color: var(--color-ai-growth);">âœ¨ HEURE D'OR</button>
        <button class="tab-btn" onclick="openTab(event, 'tab-raid')">ðŸ’¥ RAID (0-100)</button>
    </div>

    <div id="tab-dash" class="tab-content active">
        <div class="flex gap-2 mb-4">
            <input id="main-target" type="text" placeholder="ChaÃ®ne ou CatÃ©gorie..." class="flex-1 p-3 bg-black border border-gray-700 rounded outline-none focus:border-[#ff0099]">
            <button onclick="runAction('niche_analysis')" class="bg-[#ff0099] px-6 rounded font-bold">SCAN IA</button>
        </div>
        <div id="res-scan" class="min-h-[200px] border border-gray-800 p-4 rounded bg-[#0a0a0a]"></div>
    </div>

    <div id="tab-gold" class="tab-content">
        <div class="text-center">
            <h2 class="text-xl font-['Orbitron'] text-[#ffcc00] mb-4">âœ¨ DÃ‰TECTEUR D'HEURE D'OR</h2>
            <p class="text-gray-400 mb-6">Analyse de la concurrence en temps rÃ©el pour votre fuseau horaire.</p>
            <button onclick="runAction('golden_hour')" class="bg-[#ffcc00] text-black px-10 py-3 rounded-full font-bold hover:scale-105 transition">CALCULER MON CRÃ‰NEAU</button>
            <div id="res-gold" class="mt-8 text-left p-6 bg-black rounded border border-yellow-600/20"></div>
        </div>
    </div>

    <div id="tab-raid" class="tab-content">
        <div id="raid-list" class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <p class="text-gray-500 italic">Recherche de cibles potentielles...</p>
        </div>
    </div>
</div>

<script>
    // GESTION DES NOTIFICATIONS (FERMETURE AUTO)
    function notify(text) {
        const box = document.getElementById('notification-box');
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.innerHTML = `<span>${text}</span><button onclick="this.parentElement.remove()" class="ml-4 text-gray-500">âœ•</button>`;
        box.appendChild(toast);
        
        // DisparaÃ®t seul aprÃ¨s 4 secondes
        setTimeout(() => {
            toast.style.opacity = '0';
            toast.style.transition = '0.5s';
            setTimeout(() => toast.remove(), 500);
        }, 4000);
    }

    function openTab(evt, name) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(name).classList.add('active');
        evt.currentTarget.classList.add('active');
    }

    async function runAction(type) {
        const target = document.getElementById('main-target').value;
        const resDiv = type === 'golden_hour' ? document.getElementById('res-gold') : document.getElementById('res-scan');
        
        notify(`Action lancÃ©e : ${type}...`);
        resDiv.innerHTML = "<p class='text-gray-600 animate-pulse'>L'IA analyse les flux de donnÃ©es...</p>";

        try {
            const resp = await fetch('/auto_action', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action_type: type,
                    target_name: target,
                    data_context: { timezone: Intl.DateTimeFormat().resolvedOptions().timeZone }
                })
            });
            const data = await resp.json();
            resDiv.innerHTML = data.html_response;
            notify("Analyse terminÃ©e !");
        } catch (e) {
            notify("Erreur serveur.");
            resDiv.innerHTML = "Ã‰chec de l'analyse.";
        }
    }
</script>
</body>
</html>
</html>
