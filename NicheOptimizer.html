<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ORYON – Data Analytics</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&amp;family=Inter:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
<style>
    :root{
      --bg-dark:#050505;
      --bg-panel:#0b0b0d;
      --primary:#ff0099;
      --secondary:#00f2ea;
      --text-main:#e0e0e0;
      --border-color:#1f1f23;
    }
    body{
      background:var(--bg-dark);
      color:var(--text-main);
      font-family:Inter, sans-serif;
      overflow-x:auto;
    }
    .font-orbitron{ font-family:Orbitron, sans-serif; }

    ::-webkit-scrollbar{ width:6px; height:6px; }
    ::-webkit-scrollbar-track{ background:#000; }
    ::-webkit-scrollbar-thumb{ background:#333; border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover{ background:var(--secondary); }

    .glass-panel{ background:var(--bg-panel); border:1px solid var(--border-color); }

    .carousel-track{
      display:flex; gap:15px; overflow-x:auto; padding:10px 5px;
      scroll-behavior:smooth; cursor:grab;
    }
    .stream-card{
      flex:0 0 300px; height:170px; background:#111;
      border:1px solid #222; border-radius:12px; overflow:hidden;
      position:relative; cursor:pointer; transition:.2s;
    }
    .stream-card:hover{
      border-color:var(--secondary);
      transform:translateY(-4px);
      box-shadow:0 5px 20px rgba(0,242,234,.15);
    }
    .card-img{ width:100%; height:100%; object-fit:cover; opacity:.7; transition:.3s; }
    .stream-card:hover .card-img{ opacity:1; }

    /* onglets DROITE */
    .tab-nav{ display:flex; background:#080808; border-bottom:1px solid var(--border-color); }
    .tab-btn{
      flex:1; padding:14px; text-align:center; color:#666;
      font-family:Orbitron; font-size:11px; font-weight:bold;
      cursor:pointer; border-bottom:2px solid transparent; transition:.3s;
    }
    .tab-btn:hover{ color:#fff; background:#111; }
    .tab-btn.active{ color:var(--secondary); border-bottom-color:var(--secondary); background:#151515; }
    .tab-content{ display:none; height:100%; flex-direction:column; }
    .tab-content.active{ display:flex; }

    .cyber-input{
      background:#151515; border:1px solid #333; color:#fff;
      padding:12px; border-radius:6px; font-size:13px; outline:none; transition:.3s; width:100%;
    }
    .cyber-input:focus{ border-color:var(--secondary); box-shadow:0 0 10px rgba(0,242,234,.2); }

    .hub-msg{ padding:8px; border-bottom:1px solid #1a1a1a; font-size:13px; line-height:1.4; }
    .hub-msg strong{ font-family:Orbitron; font-size:11px; }
    .scrollbar-thin::-webkit-scrollbar{ width:4px; }

    /* badge statut */
    #socket-status{ transition:all .3s ease; }
    #socket-status.connected{
      color:#00f2ea; border-color:#00f2ea;
      box-shadow:0 0 8px rgba(0,242,234,.6);
      animation:hub-pulse 2s infinite;
    }
    @keyframes hub-pulse{ 0%,100%{opacity:1} 50%{opacity:.6} }

    /* BEST TIME TOOL */
    .best-time-tool{
      background:#151515; border:1px solid #00f2ea; border-radius:10px;
      padding:16px; margin-bottom:16px; box-shadow:inset 0 0 10px rgba(0,242,234,.1);
    }
    .best-time-tool h4{
      color:#00f2ea; font-family:Orbitron; font-size:12px;
      margin-bottom:10px; border-bottom:1px solid #00f2ea; padding-bottom:8px;
    }
    .best-time-tool input{
      width:100%; padding:10px; background:#0a0a0a; border:1px solid #333;
      color:#fff; border-radius:6px; font-size:12px; margin-bottom:8px;
    }
    .best-time-tool input:focus{ border-color:#00f2ea; box-shadow:0 0 8px rgba(0,242,234,.2); outline:none; }
    .best-time-tool button{
      width:100%; background:#00f2ea; color:#000; padding:10px;
      border:none; border-radius:6px; font-weight:bold; cursor:pointer;
      font-family:Orbitron; font-size:11px; transition:all .3s ease;
    }
    .best-time-tool button:hover:not(:disabled){ background:#fff; box-shadow:0 0 15px rgba(0,242,234,.4); transform:translateY(-1px); }
    .best-time-tool button:disabled{ opacity:.5; cursor:not-allowed; }
    .best-time-results{
      background:#0a0a0a; border:1px solid #333; border-radius:6px;
      padding:12px; margin-top:12px; font-size:12px; max-height:220px; overflow-y:auto;
    }
    .best-time-spinner{
      display:inline-block; width:14px; height:14px;
      border:2px solid rgba(0,242,234,.3); border-radius:50%;
      border-top-color:#00f2ea; animation:bt-spin 1s linear infinite;
      margin-right:6px; vertical-align:middle;
    }
    @keyframes bt-spin{ to{ transform:rotate(360deg) } }

    /* PLAYER sizing (grand) */
    .player-shell{ min-height:72vh; }
    #video-container{ min-height:62vh; }

    /* ====== ONGLETS SOUS LE LIVE (indépendants) ====== */
    .u-nav{ display:flex; background:#080808; border-bottom:1px solid #1f1f23; }
    .u-tab-btn{
      flex:1; padding:12px; text-align:center; color:#666;
      font-family:Orbitron; font-size:11px; font-weight:bold;
      cursor:pointer; border-bottom:2px solid transparent; transition:.25s;
    }
    .u-tab-btn:hover{ color:#fff; background:#111; }
    .u-tab-btn.active{ color:var(--secondary); border-bottom-color:var(--secondary); background:#151515; }

    .u-tab-panel{ display:none; }
    .u-tab-panel.active{ display:block; }

    /* ====== ORYON TV MODAL ====== */

/* ORYON TV wordmark (Netflix-like) */
.twitflix-wordmark{
  font-family: Arial Black, Impact, system-ui, -apple-system, Segoe UI, Roboto, sans-serif !important;
  letter-spacing: .06em !important;
  font-weight: 900 !important;
  font-size: 18px !important;
  color:#e50914 !important;
  text-transform: uppercase !important;
}
.twitflix-btn{
  border-color: rgba(229,9,20,.55) !important;
  box-shadow: 0 0 0 1px rgba(229,9,20,.18) inset, 0 0 14px rgba(229,9,20,.12) !important;
}
.twitflix-btn:hover{
  border-color: rgba(229,9,20,.85) !important;
  box-shadow: 0 0 0 1px rgba(229,9,20,.25) inset, 0 0 18px rgba(229,9,20,.18) !important;
}
    .tf-modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.9); backdrop-filter: none;
      z-index: 9999; display: none; align-items: center; justify-content: center;
    }
    .tf-modal-overlay.active { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

/* ORYON TV logo (Netflix-like) */
#twitflix-modal .tf-brand .tf-logo{
  font-family: Inter, sans-serif;
  font-weight: 900;
  letter-spacing: .12em;
  font-size: 20px;
  color: #e50914; /* Netflix red */
  text-transform: uppercase;
  text-shadow: 0 10px 30px rgba(0,0,0,.55);
}

/* ORYON TV open/close animations (modal) */
.tf-modal-overlay.active .tf-modal-content{
  animation: tfPopIn .38s cubic-bezier(.2,.9,.2,1) both;
}
@keyframes tfPopIn{
  from{ opacity:0; transform: translateY(10px) scale(.97); }
  to{ opacity:1; transform: translateY(0) scale(1); }
}
.tf-modal-overlay.closing{
  display:flex;
  animation: tfFadeOut .26s ease both;
}
@keyframes tfFadeOut{ from{opacity:1;} to{opacity:0;} }

/* ORYON TV intro/outro overlay */
.tf-intro{
  position: fixed;
  inset: 0;
  z-index: 10050;
  display:none;
  align-items:center;
  justify-content:center;
  background: radial-gradient(ellipse at center, rgba(30,0,0,.65), rgba(0,0,0,.92));
  backdrop-filter: none;
}
.tf-intro.active{ display:flex; }
.tf-intro .tf-intro-box{
  position: relative;
  width: min(520px, 92vw);
  padding: 34px 26px;
  border-radius: 18px;
  background: rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 22px 60px rgba(0,0,0,.55);
  overflow: hidden;
  transform: translateY(6px);
  animation: tfIntroIn .55s cubic-bezier(.2,.9,.2,1) both;
}
.tf-intro.outro .tf-intro-box{
  animation: tfIntroOut .45s ease both;
}
@keyframes tfIntroIn{
  from{ opacity:0; transform: translateY(16px) scale(.98); }
  to{ opacity:1; transform: translateY(0) scale(1); }
}
@keyframes tfIntroOut{
  from{ opacity:1; transform: translateY(0) scale(1); }
  to{ opacity:0; transform: translateY(10px) scale(.98); }
}
.tf-intro .tf-scanline{
  position:absolute;
  left:-40%;
  top:0;
  width: 40%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(229,9,20,.22), transparent);
  transform: skewX(-18deg);
  animation: tfScan 1.05s ease both;
}
.tf-intro.outro .tf-scanline{
  animation: tfScanOut .65s ease both;
}
@keyframes tfScan{
  from{ left:-45%; opacity:0; }
  20%{ opacity:1; }
  to{ left:110%; opacity:.0; }
}
@keyframes tfScanOut{
  from{ left:-10%; opacity:.8; }
  to{ left:110%; opacity:0; }
}
.tf-intro .tf-intro-logo{
  font-family: Inter, sans-serif;
  font-weight: 900;
  letter-spacing: .14em;
  color:#e50914;
  font-size: 34px;
  text-transform: uppercase;
  text-align:center;
}
.tf-intro .tf-intro-sub{
  margin-top: 10px;
  font-size: 12px;
  color: rgba(255,255,255,.78);
  text-align:center;
}

    .tf-modal-content {
      width: 90%; max-width: 1200px; height: 85vh;
      background: #0b0b0d; border: 1px solid #333; border-radius: 12px;
      display: flex; flex-direction: column; overflow: hidden;
      box-shadow: 0 0 40px rgba(0, 242, 234, 0.1);
    }
    .tf-header {
      padding: 20px; border-bottom: 1px solid #222;
      display: flex; justify-content: space-between; align-items: center;
      background: #080808;
    }
    .tf-title { font-family: 'Orbitron'; color: #ff0099; font-size: 24px; letter-spacing: 2px; }
    .tf-title span { color: #00f2ea; }
    .tf-close { color: #666; cursor: pointer; font-size: 24px; transition: .3s; }
    .tf-close:hover { color: #fff; transform: rotate(90deg); }

    .tf-grid{padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 20px;
      align-content: start;
      overflow: visible; /* IMPORTANT: no inner scroll */}
    .tf-card {
      position: relative; aspect-ratio: 3/4; border-radius: 6px; overflow: hidden;
      cursor: pointer; transition: transform 0.2s, border-color 0.2s;
      border: 2px solid transparent;
    }
    .tf-card:hover {
      transform: scale(1.05); border-color: #00f2ea; z-index: 10;
      box-shadow: 0 0 15px rgba(0, 242, 234, 0.3);
    }
    .tf-poster { width: 100%; height: 100%; object-fit: cover; }
    .tf-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      background: linear-gradient(to top, black, transparent);
      padding: 10px; opacity: 0; transition: 0.3s;
    }
    .tf-card:hover .tf-overlay { opacity: 1; }
    .tf-name { font-size: 12px; font-weight: bold; color: white; text-align: center; }
  
    /* ====== ORYON TV — Netflix rows (catalogue only, sans toucher le reste) ====== */
    .tf-controls{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      padding: 0 16px 12px 16px;
      border-bottom:1px solid #1f1f23;
      background: rgba(11,11,13,.92);
    }
    .tf-view-toggle{
      display:flex; gap:6px; padding:4px; border-radius:12px;
      border:1px solid #2b2b31; background:#0a0a0a;
    }
    .tf-toggle-btn{
      border:0; background:transparent; color:#a7a7b2;
      font-family:Orbitron; font-size:10px; font-weight:900;
      letter-spacing:.10em;
      padding:8px 10px; border-radius:10px; cursor:pointer; transition:.2s;
    }
    .tf-toggle-btn:hover{ color:#fff; background:#151515; }
    .tf-toggle-btn.active{ color:#000; background:#00f2ea; box-shadow:0 0 12px rgba(0,242,234,.18); }

    .tf-grid{ padding: 14px 16px 18px 16px; }
    .tf-section{ margin-top: 18px; }
    .tf-section-title{
      font-family: Orbitron, sans-serif;
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: #eaeaf0;
      margin: 8px 0 10px 2px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .tf-section-title .hint{ color:#7f7f8a; font-size:10px; letter-spacing:.06em; text-transform:none; font-family:Inter; font-weight:700; }

    .tf-row-track{
      display:flex;
      gap: 14px;
      overflow-x:auto;
      padding-bottom: 10px;
      scroll-behavior:smooth;
      -webkit-overflow-scrolling: touch;
    }
    .tf-row-track::-webkit-scrollbar{ height: 6px; }
    .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
    .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

    /* Card sizing for rows (lisible) */
    .tf-card{ flex: 0 0 170px; aspect-ratio: 2/3; }
    .tf-card:hover{ transform: scale(1.06); } /* moins agressif pour éviter le clipping */
    .tf-name{ font-size: 11px; font-weight: 900; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* A–Z bar */
    .tf-azbar{
      position: sticky;
      top: 0;
      z-index: 30;
      display:flex;
      flex-wrap:wrap;
      gap: 6px;
      padding: 10px 0 8px 0;
      background: linear-gradient(180deg, rgba(11,11,13,.98), rgba(11,11,13,.74));
      border-bottom: 1px solid #1f1f23;
      margin-bottom: 8px;
    }
    .tf-azlink{
      font-family: Orbitron, sans-serif;
      font-size: 10px;
      font-weight: 900;
      letter-spacing: .12em;
      color:#a7a7b2;
      text-decoration:none;
      padding: 6px 8px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      transition:.2s;
    }
    .tf-azlink:hover{
      color:#000;
      background:#00f2ea;
      border-color:#00f2ea;
    }


    /* ====== ORYON TV — performance + Netflix rows ====== */
    .tf-rows{
      flex: 1;
      overflow-y: auto;
      padding: 18px;
      display: block;
    }
    .tf-row{ margin-bottom: 22px; }
    .tf-row-title{
      font-family: Orbitron, sans-serif;
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color:#eaeaf0;
      margin: 8px 0 10px 2px;
    }
    .tf-row-title span{ color:#00f2ea; }
    .tf-row-track{
      display:flex;
      gap: 14px;
      overflow-x:auto;
      padding-bottom: 10px;
      scroll-behavior:smooth;
      -webkit-overflow-scrolling: touch;
    }
    .tf-row-track::-webkit-scrollbar{ height: 6px; }
    .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
    .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

    .tf-az{
      flex: 1;
      overflow-y: auto;
      padding: 18px;
      display:block;
    }
    .tf-azbar{
      position: sticky;
      top: 0;
      z-index: 30;
      display:flex;
      flex-wrap:wrap;
      gap: 6px;
      padding: 10px 0 8px 0;
      background: linear-gradient(180deg, rgba(11,11,13,.98), rgba(11,11,13,.78));
      border-bottom: 1px solid #1f1f23;
      margin-bottom: 10px;
    }
    .tf-azlink{
      font-family: Orbitron, sans-serif;
      font-size: 10px;
      font-weight: 900;
      letter-spacing: .12em;
      color:#a7a7b2;
      text-decoration:none;
      padding: 6px 8px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      transition:.2s;
    }
    .tf-azlink:hover{
      color:#000;
      background:#00f2ea;
      border-color:#00f2ea;
    }

    .tf-sentinel{
      padding: 18px 0 4px 0;
      display:flex;
      justify-content:center;
    }
    .tf-sentinel-inner{
      font-size: 12px;
      color:#9b9ba3;
      background:#0a0a0a;
      border:1px solid #2b2b31;
      border-radius: 12px;
      padding: 10px 14px;
    }
    .tf-sentinel-inner.done{
      color:#00f2ea;
      border-color:#00f2ea;
      background: rgba(0,242,234,.06);
    }
    .tf-retry{
      background:#151515;
      border:1px solid #2b2b31;
      color:#fff;
      padding:10px 14px;
      border-radius: 12px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      transition:.2s;
    }
    .tf-retry:hover{
      border-color:#00f2ea;
      box-shadow:0 0 18px rgba(0,242,234,.18);
      transform: translateY(-1px);
    }


    /* ORYON TV search (Netflix style) */
    .tf-search-wrap{ position:relative; width:min(520px, 100%); }
    .tf-search{
      width:100%;
      background:#0a0a0a;
      border:1px solid #2b2b31;
      color:#fff;
      border-radius:10px;
      padding:10px 12px 10px 36px;
      font-size:13px;
      outline:none;
      transition:.2s;
    }
    .tf-search:focus{
      border-color:#00f2ea;
      box-shadow:0 0 0 3px rgba(0,242,234,.12);
    }
    .tf-search-ico{
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      color:#777;
      font-size:13px;
      pointer-events:none;
    }


/* === ORYON TV UX Overhaul (Netflix-like) — overrides only (does not touch rest of app) === */
#twitflix-modal .tf-modal-content{ max-width: 1400px; }

#twitflix-modal .tf-topbar{ position: sticky; top:0; z-index: 60; }
#twitflix-modal .tf-actions{ gap: 12px; }
#twitflix-modal .tf-search{ font-size: 14px; padding: 12px 14px 12px 38px; }

#twitflix-modal .tf-body{
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* Conteneur de contenu (ne scroll plus lui-même, le scroll est sur .tf-body) */
#twitflix-modal .tf-body{
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* Conteneur de contenu (ne scroll plus lui-même, le scroll est sur .tf-body) */
#twitflix-modal .tf-grid{
  display:flex;
  flex-direction: column;
  gap: 18px;
  padding: 14px 18px 24px 18px;
  flex: 0 0 auto;
  min-height: auto;
  overflow: visible;
}

#twitflix-modal .tf-hero{
  position: relative;
  height: 220px;
  border-radius: 14px;
  overflow:hidden;
  border:1px solid #1f1f23;
  background: #0a0a0a;
}
#twitflix-modal .tf-hero::before{
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(circle at 30% 20%, rgba(0,242,234,.18), transparent 60%),
              radial-gradient(circle at 80% 30%, rgba(255,0,153,.14), transparent 55%),
              linear-gradient(to top, rgba(0,0,0,.92), rgba(0,0,0,.20));
  z-index:2;
}
#twitflix-modal .tf-hero-bg{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit: cover;
  filter: saturate(1.05) contrast(1.05);
  opacity:.55;
}
#twitflix-modal .tf-hero-content{
  position:absolute; inset:0;
  z-index:3;
  display:flex;
  align-items:flex-end;
  padding: 18px;
}
#twitflix-modal .tf-hero-title{
  font-family: Arial Black, Impact, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  letter-spacing: .02em;
  font-size: 44px;
  font-weight: 900;
  color:#e50914;
  line-height: 1;
  text-transform: uppercase;
  text-shadow: 0 10px 30px rgba(0,0,0,.85);
}
#twitflix-modal .tf-hero-sub{
  margin-top: 6px;
  font-size: 12px;
  color:#cfcfda;
  max-width: 70ch;
  line-height: 1.35;
}

#twitflix-modal .tf-row{ display:flex; flex-direction:column; gap: 10px; }
#twitflix-modal .tf-row-title{
  font-family: Orbitron, sans-serif;
  letter-spacing: .14em;
  text-transform: uppercase;
  font-size: 12px;
  color:#eaeaf0;
  display:flex; align-items:center; justify-content:space-between;
}
#twitflix-modal .tf-row-title span{ color:#00f2ea; }
#twitflix-modal .tf-row-track{
  display:flex;
  gap: 16px;
  overflow-x:auto;
  padding-bottom: 10px;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling: touch;
}
#twitflix-modal .tf-row-track::-webkit-scrollbar{ height: 6px; }
#twitflix-modal .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
#twitflix-modal .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

#twitflix-modal .tf-card{
  flex: 0 0 170px;
  border-radius: 12px;
  overflow:hidden;
  background:#101013;
  border:1px solid #1d1d22;
  transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
}
#twitflix-modal .tf-card:hover{
  transform: scale(1.06);
  z-index: 40;
  border-color:#00f2ea;
  box-shadow: 0 18px 45px rgba(0,0,0,.55), 0 0 18px rgba(0,242,234,.18);
}
#twitflix-modal .tf-poster{
  width:100%; height:100%;
  object-fit: cover;
  transform: scale(1.02);
  opacity:.95;
}
#twitflix-modal .tf-card:hover .tf-poster{ opacity:.35; }

#twitflix-modal .tf-overlay{
  padding: 10px 10px 12px 10px;
}
#twitflix-modal .tf-name{
  font-size: 12px;
  font-weight: 900;
  white-space: nowrap;
  overflow:hidden;
  text-overflow: ellipsis;
}
#twitflix-modal .tf-meta{ display:none; } /* cache le texte “Survol…” */
#twitflix-modal .tf-actions-row{
  display:flex;
  gap:8px;
  justify-content:center;
  margin-top: 10px;
}
#twitflix-modal .tf-pill{
  display:inline-flex; align-items:center; gap:6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 900;
  color:#000;
  background:#00f2ea;
}
#twitflix-modal .tf-pill.ghost{
  background: rgba(255,255,255,.08);
  color:#e8e8ee;
  border:1px solid rgba(255,255,255,.14);
}

#twitflix-modal .tf-search-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 16px;
  padding-top: 10px;
}

#twitflix-modal .tf-azbar{
  position: sticky;
  top: 66px; /* sous la topbar */
  z-index: 55;
  display:flex;
  flex-wrap:wrap;
  gap: 6px;
  padding: 10px 0 8px 0;
  background: linear-gradient(180deg, rgba(11,11,13,.96), rgba(11,11,13,.72));
  border-bottom: 1px solid #1f1f23;
}
#twitflix-modal .tf-azlink{
  font-family: Orbitron, sans-serif;
  font-size: 10px;
  font-weight: 900;
  letter-spacing: .12em;
  color:#a7a7b2;
  text-decoration:none;
  padding: 6px 8px;
  border-radius: 10px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.12);
  transition:.2s;
}
#twitflix-modal .tf-azlink:hover{ color:#000; background:#00f2ea; border-color:#00f2ea; }

#twitflix-modal .tf-end{
  text-align:center;
  color:#9b9ba3;
  padding: 18px 0 6px 0;
}
#twitflix-modal .tf-retry{
  margin-top: 10px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid #2b2b31;
  background:#151515;
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
#twitflix-modal .tf-retry:hover{ border-color:#00f2ea; box-shadow:0 0 18px rgba(0,242,234,.18); transform: translateY(-1px); }


    /* HUB extras (emotes, gifs, réactions) */
    .hub-emo{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:#e8e8ee;
      padding:6px 10px;
      border-radius: 10px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
    }
    .hub-emo:hover{ border-color:#00f2ea; box-shadow:0 0 12px rgba(0,242,234,.15); }
    .hub-msg{
      padding:8px 10px;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .hub-badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-weight:900;
      font-size:10px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      margin-left:6px;
    }
    .hub-gif{
      margin-top:6px;
      border-radius: 12px;
      max-width: 260px;
      border:1px solid rgba(255,255,255,.10);
    }
    .hub-reactions{
      display:flex;
      gap:6px;
      margin-top:6px;
      flex-wrap:wrap;
      align-items:center;
    }
    .hub-react-btn{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color:#fff;
      font-size:12px;
      cursor:pointer;
    }
    .hub-react-btn:hover{ border-color:#00f2ea; }
    .hub-react-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color:#e8e8ee;
      font-size:12px;
    }



/* === EXTRAORDINAIRES (SAFE) === */
.hub-msg .hub-react-row{ opacity:0; max-height:0; overflow:hidden; transition: .18s ease; }
.hub-msg:hover .hub-react-row{ opacity:1; max-height:40px; }
.hub-msg.is-tapped .hub-react-row{ opacity:1; max-height:40px; }

.hub-gif{ max-width: 240px; border-radius: 10px; margin-top: 8px; border:1px solid rgba(255,255,255,.10); display:block; }

#ambilight{
  position:absolute; inset:-14px;
  filter: none;
  opacity:.55;
  z-index:0;
  pointer-events:none;
  transition: background .25s ease;
}
#player-wrap{ position:relative; }
#player-wrap > *{ position:relative; z-index:1; }

.mosaic-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  gap: 8px;
  width: 100%;
  height: 100%;
}
.mosaic-grid iframe{ width:100%; height:100%; border:0; border-radius:14px; }

.vibe-chill{ border:1px solid rgba(34,197,94,.55)!important; box-shadow: 0 0 0 1px rgba(34,197,94,.25) inset; }
.vibe-hype{ border:1px solid rgba(0,242,234,.70)!important; box-shadow: 0 0 0 1px rgba(0,242,234,.25) inset; }
.vibe-toxic{ border:1px solid rgba(239,68,68,.60)!important; box-shadow: 0 0 0 1px rgba(239,68,68,.22) inset; }


    /* ==== HUB Chat UX fixes ==== */
    #chat-container-hub { min-height: 520px; }
    #hub-messages { scroll-behavior: smooth; padding-bottom: 90px; }
    /* Keep input always visible */
    #chat-container-hub form { position: sticky; bottom: 0; z-index: 20; }

    /* Messenger-like reactions: hidden until hover/tap */
    .hub-react-row{ 
      opacity: 0; 
      max-height: 0; 
      overflow: hidden;
      pointer-events: none;
      transform: translateY(-4px);
      transition: opacity .15s ease, max-height .15s ease, transform .15s ease;
    }
    .hub-msg:hover .hub-react-row, .hub-msg.show-reactions .hub-react-row{
      opacity: 1;
      max-height: 44px;
      pointer-events: auto;
      transform: translateY(0);
    }
    .hub-react-btn{
      width: 34px; height: 34px;
      display:inline-flex; align-items:center; justify-content:center;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
    }
    .hub-react-btn:hover{ border-color:#00f2ea; }
    .hub-reactions{ display:flex; gap:6px; flex-wrap:wrap; margin-top:10px; }
    .hub-reaction-pill{
      display:inline-flex; align-items:center; gap:6px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    /* Ensure modules below player aren't clipped inside iframe */
    body { overflow-y: auto; }
    .page-wrap { padding-bottom: 40px; }


/* === Tools overlay (safe) === */

#player-tools{
  position:absolute;
  top:10px;
  right:10px;
  z-index:99999 !important;
  display:flex;
  gap:8px;
  pointer-events:auto;
}
#player-tools .toolbtn{ pointer-events:auto; }
#video-container iframe{ position:relative; z-index:1 !important; }
#video-container .player-wrap, #video-container #player{ position:relative; z-index:1 !important; }

#video-container{ position:relative; overflow: visible !important; }
.toolbtn{
  width:38px;height:34px;border-radius:12px;
  background:rgba(16,16,18,.86);
  border:1px solid rgba(255,255,255,.18);
  color:#fff;font-weight:900;cursor:pointer;
}
.toolbtn:hover{ border-color:#00f2ea; transform: translateY(-1px); }
.toolbtn.active{ border-color:#00f2ea; box-shadow:0 0 0 2px rgba(0,242,234,.22) inset; }

#ambilight{
  position:absolute; inset:-90px; z-index:0;
  filter: none;
  opacity:0;
  pointer-events:none;
  transition: opacity .2s ease;
}
#ambilight.on{ opacity:.78; }

#video-container iframe, #video-container .player-wrap, #video-container #player{ position:relative; z-index:2; }

/* Vibe borders */
.vibe-chill{ box-shadow: 0 0 0 2px rgba(0,242,234,.35) inset, 0 0 18px rgba(0,242,234,.18); }
.vibe-hype{ box-shadow: 0 0 0 2px rgba(255,0,153,.35) inset, 0 0 18px rgba(255,0,153,.18); }
.vibe-toxic{ box-shadow: 0 0 0 2px rgba(255,214,0,.35) inset, 0 0 18px rgba(255,214,0,.18); }

/* Modals (reuse if not already) */
.modal-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.75);
  display:none; align-items:center; justify-content:center;
  z-index:99999;
}
.modal-overlay.active{ display:flex; }
.modal-card{
  width:min(1100px,94vw);
  max-height:92vh;
  overflow:auto;
  background:#0b0b0d;
  border:1px solid rgba(255,255,255,.12);
  border-radius:18px;
  box-shadow: 0 0 40px rgba(0,0,0,.6);
  padding:14px;
}
.modal-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:6px 6px 12px; }
.modal-title{ font-family:Orbitron, sans-serif; letter-spacing:.12em; font-weight:900; font-size:12px; color:#eaeaf0; text-transform:uppercase; }
.modal-close{
  background:#151515; border:1px solid #2b2b31; color:#fff;
  width:36px; height:36px; border-radius:12px; cursor:pointer;
}
.modal-close:hover{ border-color:#00f2ea; }

.mosaic-grid{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; }
.mosaic-tile{ background:#000; border:1px solid rgba(255,255,255,.12); border-radius:14px; overflow:hidden; position:relative; aspect-ratio:16/9; }
.mosaic-tile button{
  position:absolute; top:10px; right:10px;
  background:rgba(0,0,0,.55);
  border:1px solid rgba(255,255,255,.18);
  color:#fff; border-radius:12px;
  padding:6px 10px; font-weight:900; cursor:pointer;
}
.mosaic-tile button:hover{ border-color:#00f2ea; }


/* === FORCE PLAYER + SIDE PANEL ALWAYS SIDE-BY-SIDE (embed-safe) === */
#main-layout{ 
      /* HARD FIX: force 2-column layout even if Tailwind is blocked by CSP */
      display: grid !important;
      grid-template-columns: minmax(0, 1fr) 420px;
      gap: 18px;
      align-items: stretch;
      min-height: 0;
    }
    /* Left column (player + top modules) */
    #main-layout > .col-span-8{ grid-column: 1 / 2; min-width: 0; }
    /* Right column (Chat/Stats/Tools) */
    #side-panel{ grid-column: 2 / 3; min-width: 320px; width: 100%; }
    /* Responsive: stack on small screens */
    @media (max-width: 1100px){
      #main-layout{ grid-template-columns: 1fr; }
      #main-layout > .col-span-8{ grid-column: 1 / -1; }
      #side-panel{ grid-column: 1 / -1; min-width: 0; }
    }
#main-layout > .col-span-8{ min-width: 640px; }
#side-panel{ min-width: 360px; max-width: 520px; }


/* === FIX: Sidebar chat should NOT deform Twitch player === */
#main-layout{ align-items: start !important; }
.player-shell{
  flex: 0 0 auto !important;
  height: clamp(520px, 72vh, 860px) !important;
  min-height: unset !important;
}
#video-container{
  flex: 1 1 auto !important;
  min-height: unset !important;
  height: 100% !important;
}


/* === FIX: side-panel height locked to player (Hub Secure can't stretch layout) === */
#side-panel{
  height: clamp(520px, 72vh, 860px) !important;
  min-height: 0 !important;
}
#tab-chat{
  min-height: 0 !important;
}
#chat-container-twitch,
#chat-container-hub{
  flex: 1 1 auto !important;
  min-height: 0 !important;
}
#hub-messages{
  min-height: 0 !important;
}

/* Ensure chat iframe can't force extra height */
#twitch-chat-frame{ display:block; width:100%; height:100%; }

/* === FIX: Messenger-like reactions (attached to message) without layout shift === */
.hub-msg{ position: relative !important; padding-bottom: 34px !important; }

/* Pills (existing reactions) stick to the bottom-right of the message */
.hub-reactions{
  position: absolute !important;
  right: 10px !important;
  bottom: 8px !important;
  margin: 0 !important;
  display: inline-flex !important;
  gap: 6px !important;
  flex-wrap: wrap !important;
  justify-content: flex-end !important;
  pointer-events: none !important;
}
/* Hide empty reactions container */
.hub-reactions:empty{ display:none !important; }

/* Reaction picker appears just above the pills, like Messenger */
.hub-react-row{
  position: absolute !important;
  right: 10px !important;
  bottom: 36px !important;
  opacity: 0 !important;
  pointer-events: none !important;
  transform: translateY(6px) !important;
  transition: opacity .15s ease, transform .15s ease !important;
  z-index: 5 !important;
}
.hub-msg:hover .hub-react-row,
.hub-msg.show-reactions .hub-react-row{
  opacity: 1 !important;
  pointer-events: auto !important;
  transform: translateY(0) !important;
}


/* HARD LAYOUT FIX: keep player left + side panel right even if Tailwind CDN/CSP fails */
#main-layout{
  display:grid !important;
  grid-template-columns:minmax(0,1fr) 420px !important;
  gap:16px !important;
  align-items:stretch !important;
  min-height:0 !important;
}
#main-layout > .col-span-8{ grid-column:1 !important; min-width:0 !important; }
#side-panel{ grid-column:2 !important; min-width:0 !important; height:100% !important; }
@media (max-width: 1100px){
  #main-layout{ grid-template-columns:1fr !important; }
  #side-panel{ grid-column:1 !important; }
}
/* Centered Market modal like ORYON TV */
#market-overlay .market-modal{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(1200px,96vw);
  height:min(88vh,900px);
  border-radius:18px;
  overflow:hidden;
}


/* ======= HARD FIXES (no-tailwind fallback + layout locks) ======= */
.hidden{display:none !important;}
/* force main layout: player left, side-panel right */
#main-layout{display:grid !important; grid-template-columns:minmax(0,1fr) 420px; gap:16px; align-items:stretch;}
#side-panel{grid-column:2 / 3 !important; min-width:320px;}
#left-col{grid-column:1 / 2 !important; min-width:0;}
/* player/side-panel height lock via CSS var */
:root{ --playerH: 520px; --sideHeaderH: 44px; }
#side-panel{height:var(--playerH) !important;}
#side-panel .tab-content{min-height:0;}
#tab-chat, #tab-stats, #tab-tools{height:calc(var(--playerH) - var(--sideHeaderH)) !important; overflow:hidden;}
#tab-chat{display:flex; flex-direction:column;}
#tab-chat .chat-mode-bar{height:40px;}
#chat-container-twitch, #chat-container-hub{min-height:0; height:calc(100% - 40px) !important;}
#chat-container-hub{display:flex; flex-direction:column;}
#hub-messages{min-height:0;}
/* tools internal scroll (so you can reach bottom) */
#tab-tools{display:flex; flex-direction:column;}
#tab-tools .tools-scroll{flex:1; min-height:0; overflow:auto;}
/* market overlay always centered like ORYON TV */
#market-overlay{position:fixed !important; inset:0 !important; display:flex; align-items:center; justify-content:center;}
#market-overlay.hidden{display:none !important;}
#market-overlay .market-modal{width:min(1100px, calc(100vw - 32px)); height:min(78vh, 720px); max-height:calc(100vh - 32px);}
@media (max-width: 980px){
  #main-layout{grid-template-columns:1fr; }
  #side-panel{grid-column:1 / 2 !important; height:auto !important;}
  #tab-chat, #tab-stats, #tab-tools{height:auto !important;}
}

/* Phase2: never overlay player tools above modals */
body.modal-open #player-tools{display:none !important;}


/* === BINANCE MARKET UI === */

    :root{
      --bg-dark:#050505;
      --bg-panel:#0b0b0d;
      --primary:#ff0099;
      --secondary:#00f2ea;
      --text-main:#e0e0e0;
      --border-color:#1f1f23;
    }
    body{
      background:var(--bg-dark);
      color:var(--text-main);
      font-family:Inter, sans-serif;
      overflow-x:auto;
    }
    .font-orbitron{ font-family:Orbitron, sans-serif; }

    ::-webkit-scrollbar{ width:6px; height:6px; }
    ::-webkit-scrollbar-track{ background:#000; }
    ::-webkit-scrollbar-thumb{ background:#333; border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover{ background:var(--secondary); }

    .glass-panel{ background:var(--bg-panel); border:1px solid var(--border-color); }

    .carousel-track{
      display:flex; gap:15px; overflow-x:auto; padding:10px 5px;
      scroll-behavior:smooth; cursor:grab;
    }
    .stream-card{
      flex:0 0 300px; height:170px; background:#111;
      border:1px solid #222; border-radius:12px; overflow:hidden;
      position:relative; cursor:pointer; transition:.2s;
    }
    .stream-card:hover{
      border-color:var(--secondary);
      transform:translateY(-4px);
      box-shadow:0 5px 20px rgba(0,242,234,.15);
    }
    .card-img{ width:100%; height:100%; object-fit:cover; opacity:.7; transition:.3s; }
    .stream-card:hover .card-img{ opacity:1; }

    /* onglets DROITE */
    .tab-nav{ display:flex; background:#080808; border-bottom:1px solid var(--border-color); }
    .tab-btn{
      flex:1; padding:14px; text-align:center; color:#666;
      font-family:Orbitron; font-size:11px; font-weight:bold;
      cursor:pointer; border-bottom:2px solid transparent; transition:.3s;
    }
    .tab-btn:hover{ color:#fff; background:#111; }
    .tab-btn.active{ color:var(--secondary); border-bottom-color:var(--secondary); background:#151515; }
    .tab-content{ display:none; height:100%; flex-direction:column; }
    .tab-content.active{ display:flex; }

    .cyber-input{
      background:#151515; border:1px solid #333; color:#fff;
      padding:12px; border-radius:6px; font-size:13px; outline:none; transition:.3s; width:100%;
    }
    .cyber-input:focus{ border-color:var(--secondary); box-shadow:0 0 10px rgba(0,242,234,.2); }

    .hub-msg{ padding:8px; border-bottom:1px solid #1a1a1a; font-size:13px; line-height:1.4; }
    .hub-msg strong{ font-family:Orbitron; font-size:11px; }
    .scrollbar-thin::-webkit-scrollbar{ width:4px; }

    /* badge statut */
    #socket-status{ transition:all .3s ease; }
    #socket-status.connected{
      color:#00f2ea; border-color:#00f2ea;
      box-shadow:0 0 8px rgba(0,242,234,.6);
      animation:hub-pulse 2s infinite;
    }
    @keyframes hub-pulse{ 0%,100%{opacity:1} 50%{opacity:.6} }

    /* BEST TIME TOOL */
    .best-time-tool{
      background:#151515; border:1px solid #00f2ea; border-radius:10px;
      padding:16px; margin-bottom:16px; box-shadow:inset 0 0 10px rgba(0,242,234,.1);
    }
    .best-time-tool h4{
      color:#00f2ea; font-family:Orbitron; font-size:12px;
      margin-bottom:10px; border-bottom:1px solid #00f2ea; padding-bottom:8px;
    }
    .best-time-tool input{
      width:100%; padding:10px; background:#0a0a0a; border:1px solid #333;
      color:#fff; border-radius:6px; font-size:12px; margin-bottom:8px;
    }
    .best-time-tool input:focus{ border-color:#00f2ea; box-shadow:0 0 8px rgba(0,242,234,.2); outline:none; }
    .best-time-tool button{
      width:100%; background:#00f2ea; color:#000; padding:10px;
      border:none; border-radius:6px; font-weight:bold; cursor:pointer;
      font-family:Orbitron; font-size:11px; transition:all .3s ease;
    }
    .best-time-tool button:hover:not(:disabled){ background:#fff; box-shadow:0 0 15px rgba(0,242,234,.4); transform:translateY(-1px); }
    .best-time-tool button:disabled{ opacity:.5; cursor:not-allowed; }
    .best-time-results{
      background:#0a0a0a; border:1px solid #333; border-radius:6px;
      padding:12px; margin-top:12px; font-size:12px; max-height:220px; overflow-y:auto;
    }
    .best-time-spinner{
      display:inline-block; width:14px; height:14px;
      border:2px solid rgba(0,242,234,.3); border-radius:50%;
      border-top-color:#00f2ea; animation:bt-spin 1s linear infinite;
      margin-right:6px; vertical-align:middle;
    }
    @keyframes bt-spin{ to{ transform:rotate(360deg) } }

    /* PLAYER sizing (grand) */
    .player-shell{ min-height:72vh; }
    #video-container{ min-height:62vh; }

    /* ====== ONGLETS SOUS LE LIVE (indépendants) ====== */
    .u-nav{ display:flex; background:#080808; border-bottom:1px solid #1f1f23; }
    .u-tab-btn{
      flex:1; padding:12px; text-align:center; color:#666;
      font-family:Orbitron; font-size:11px; font-weight:bold;
      cursor:pointer; border-bottom:2px solid transparent; transition:.25s;
    }
    .u-tab-btn:hover{ color:#fff; background:#111; }
    .u-tab-btn.active{ color:var(--secondary); border-bottom-color:var(--secondary); background:#151515; }

    .u-tab-panel{ display:none; }
    .u-tab-panel.active{ display:block; }

    /* ====== ORYON TV MODAL ====== */
    .tf-modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.9); backdrop-filter: none;
      z-index: 9999; display: none; align-items: center; justify-content: center;
    }
    .tf-modal-overlay.active { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

/* ORYON TV logo (Netflix-like) */
#twitflix-modal .tf-brand .tf-logo{
  font-family: Inter, sans-serif;
  font-weight: 900;
  letter-spacing: .12em;
  font-size: 20px;
  color: #e50914; /* Netflix red */
  text-transform: uppercase;
  text-shadow: 0 10px 30px rgba(0,0,0,.55);
}

/* ORYON TV open/close animations (modal) */
.tf-modal-overlay.active .tf-modal-content{
  animation: tfPopIn .38s cubic-bezier(.2,.9,.2,1) both;
}
@keyframes tfPopIn{
  from{ opacity:0; transform: translateY(10px) scale(.97); }
  to{ opacity:1; transform: translateY(0) scale(1); }
}
.tf-modal-overlay.closing{
  display:flex;
  animation: tfFadeOut .26s ease both;
}
@keyframes tfFadeOut{ from{opacity:1;} to{opacity:0;} }

/* ORYON TV intro/outro overlay */
.tf-intro{
  position: fixed;
  inset: 0;
  z-index: 10050;
  display:none;
  align-items:center;
  justify-content:center;
  background: radial-gradient(ellipse at center, rgba(30,0,0,.65), rgba(0,0,0,.92));
  backdrop-filter: none;
}
.tf-intro.active{ display:flex; }
.tf-intro .tf-intro-box{
  position: relative;
  width: min(520px, 92vw);
  padding: 34px 26px;
  border-radius: 18px;
  background: rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 22px 60px rgba(0,0,0,.55);
  overflow: hidden;
  transform: translateY(6px);
  animation: tfIntroIn .55s cubic-bezier(.2,.9,.2,1) both;
}
.tf-intro.outro .tf-intro-box{
  animation: tfIntroOut .45s ease both;
}
@keyframes tfIntroIn{
  from{ opacity:0; transform: translateY(16px) scale(.98); }
  to{ opacity:1; transform: translateY(0) scale(1); }
}
@keyframes tfIntroOut{
  from{ opacity:1; transform: translateY(0) scale(1); }
  to{ opacity:0; transform: translateY(10px) scale(.98); }
}
.tf-intro .tf-scanline{
  position:absolute;
  left:-40%;
  top:0;
  width: 40%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(229,9,20,.22), transparent);
  transform: skewX(-18deg);
  animation: tfScan 1.05s ease both;
}
.tf-intro.outro .tf-scanline{
  animation: tfScanOut .65s ease both;
}
@keyframes tfScan{
  from{ left:-45%; opacity:0; }
  20%{ opacity:1; }
  to{ left:110%; opacity:.0; }
}
@keyframes tfScanOut{
  from{ left:-10%; opacity:.8; }
  to{ left:110%; opacity:0; }
}
.tf-intro .tf-intro-logo{
  font-family: Inter, sans-serif;
  font-weight: 900;
  letter-spacing: .14em;
  color:#e50914;
  font-size: 34px;
  text-transform: uppercase;
  text-align:center;
}
.tf-intro .tf-intro-sub{
  margin-top: 10px;
  font-size: 12px;
  color: rgba(255,255,255,.78);
  text-align:center;
}

    .tf-modal-content {
      width: 90%; max-width: 1200px; height: 85vh;
      background: #0b0b0d; border: 1px solid #333; border-radius: 12px;
      display: flex; flex-direction: column; overflow: hidden;
      box-shadow: 0 0 40px rgba(0, 242, 234, 0.1);
    }
    .tf-header {
      padding: 20px; border-bottom: 1px solid #222;
      display: flex; justify-content: space-between; align-items: center;
      background: #080808;
    }
    .tf-title { font-family: 'Orbitron'; color: #ff0099; font-size: 24px; letter-spacing: 2px; }
    .tf-title span { color: #00f2ea; }
    .tf-close { color: #666; cursor: pointer; font-size: 24px; transition: .3s; }
    .tf-close:hover { color: #fff; transform: rotate(90deg); }

    .tf-grid {
      flex: 1; overflow-y: auto; padding: 20px;
      display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 20px; align-content: start;
    }
    .tf-card {
      position: relative; aspect-ratio: 3/4; border-radius: 6px; overflow: hidden;
      cursor: pointer; transition: transform 0.2s, border-color 0.2s;
      border: 2px solid transparent;
    }
    .tf-card:hover {
      transform: scale(1.05); border-color: #00f2ea; z-index: 10;
      box-shadow: 0 0 15px rgba(0, 242, 234, 0.3);
    }
    .tf-poster { width: 100%; height: 100%; object-fit: cover; }
    .tf-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      background: linear-gradient(to top, black, transparent);
      padding: 10px; opacity: 0; transition: 0.3s;
    }
    .tf-card:hover .tf-overlay { opacity: 1; }
    .tf-name { font-size: 12px; font-weight: bold; color: white; text-align: center; }
  
    /* ====== ORYON TV — Netflix rows (catalogue only, sans toucher le reste) ====== */
    .tf-controls{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      padding: 0 16px 12px 16px;
      border-bottom:1px solid #1f1f23;
      background: rgba(11,11,13,.92);
    }
    .tf-view-toggle{
      display:flex; gap:6px; padding:4px; border-radius:12px;
      border:1px solid #2b2b31; background:#0a0a0a;
    }
    .tf-toggle-btn{
      border:0; background:transparent; color:#a7a7b2;
      font-family:Orbitron; font-size:10px; font-weight:900;
      letter-spacing:.10em;
      padding:8px 10px; border-radius:10px; cursor:pointer; transition:.2s;
    }
    .tf-toggle-btn:hover{ color:#fff; background:#151515; }
    .tf-toggle-btn.active{ color:#000; background:#00f2ea; box-shadow:0 0 12px rgba(0,242,234,.18); }

    .tf-grid{ padding: 14px 16px 18px 16px; }
    .tf-section{ margin-top: 18px; }
    .tf-section-title{
      font-family: Orbitron, sans-serif;
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: #eaeaf0;
      margin: 8px 0 10px 2px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .tf-section-title .hint{ color:#7f7f8a; font-size:10px; letter-spacing:.06em; text-transform:none; font-family:Inter; font-weight:700; }

    .tf-row-track{
      display:flex;
      gap: 14px;
      overflow-x:auto;
      padding-bottom: 10px;
      scroll-behavior:smooth;
      -webkit-overflow-scrolling: touch;
    }
    .tf-row-track::-webkit-scrollbar{ height: 6px; }
    .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
    .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

    /* Card sizing for rows (lisible) */
    .tf-card{ flex: 0 0 170px; aspect-ratio: 2/3; }
    .tf-card:hover{ transform: scale(1.06); } /* moins agressif pour éviter le clipping */
    .tf-name{ font-size: 11px; font-weight: 900; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* A–Z bar */
    .tf-azbar{
      position: sticky;
      top: 0;
      z-index: 30;
      display:flex;
      flex-wrap:wrap;
      gap: 6px;
      padding: 10px 0 8px 0;
      background: linear-gradient(180deg, rgba(11,11,13,.98), rgba(11,11,13,.74));
      border-bottom: 1px solid #1f1f23;
      margin-bottom: 8px;
    }
    .tf-azlink{
      font-family: Orbitron, sans-serif;
      font-size: 10px;
      font-weight: 900;
      letter-spacing: .12em;
      color:#a7a7b2;
      text-decoration:none;
      padding: 6px 8px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      transition:.2s;
    }
    .tf-azlink:hover{
      color:#000;
      background:#00f2ea;
      border-color:#00f2ea;
    }


    /* ====== ORYON TV — performance + Netflix rows ====== */
    .tf-rows{
      flex: 1;
      overflow-y: auto;
      padding: 18px;
      display: block;
    }
    .tf-row{ margin-bottom: 22px; }
    .tf-row-title{
      font-family: Orbitron, sans-serif;
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color:#eaeaf0;
      margin: 8px 0 10px 2px;
    }
    .tf-row-title span{ color:#00f2ea; }
    .tf-row-track{
      display:flex;
      gap: 14px;
      overflow-x:auto;
      padding-bottom: 10px;
      scroll-behavior:smooth;
      -webkit-overflow-scrolling: touch;
    }
    .tf-row-track::-webkit-scrollbar{ height: 6px; }
    .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
    .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

    .tf-az{
      flex: 1;
      overflow-y: auto;
      padding: 18px;
      display:block;
    }
    .tf-azbar{
      position: sticky;
      top: 0;
      z-index: 30;
      display:flex;
      flex-wrap:wrap;
      gap: 6px;
      padding: 10px 0 8px 0;
      background: linear-gradient(180deg, rgba(11,11,13,.98), rgba(11,11,13,.78));
      border-bottom: 1px solid #1f1f23;
      margin-bottom: 10px;
    }
    .tf-azlink{
      font-family: Orbitron, sans-serif;
      font-size: 10px;
      font-weight: 900;
      letter-spacing: .12em;
      color:#a7a7b2;
      text-decoration:none;
      padding: 6px 8px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      transition:.2s;
    }
    .tf-azlink:hover{
      color:#000;
      background:#00f2ea;
      border-color:#00f2ea;
    }

    .tf-sentinel{
      padding: 18px 0 4px 0;
      display:flex;
      justify-content:center;
    }
    .tf-sentinel-inner{
      font-size: 12px;
      color:#9b9ba3;
      background:#0a0a0a;
      border:1px solid #2b2b31;
      border-radius: 12px;
      padding: 10px 14px;
    }
    .tf-sentinel-inner.done{
      color:#00f2ea;
      border-color:#00f2ea;
      background: rgba(0,242,234,.06);
    }
    .tf-retry{
      background:#151515;
      border:1px solid #2b2b31;
      color:#fff;
      padding:10px 14px;
      border-radius: 12px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      transition:.2s;
    }
    .tf-retry:hover{
      border-color:#00f2ea;
      box-shadow:0 0 18px rgba(0,242,234,.18);
      transform: translateY(-1px);
    }


    /* ORYON TV search (Netflix style) */
    .tf-search-wrap{ position:relative; width:min(520px, 100%); }
    .tf-search{
      width:100%;
      background:#0a0a0a;
      border:1px solid #2b2b31;
      color:#fff;
      border-radius:10px;
      padding:10px 12px 10px 36px;
      font-size:13px;
      outline:none;
      transition:.2s;
    }
    .tf-search:focus{
      border-color:#00f2ea;
      box-shadow:0 0 0 3px rgba(0,242,234,.12);
    }
    .tf-search-ico{
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      color:#777;
      font-size:13px;
      pointer-events:none;
    }


/* === ORYON TV UX Overhaul (Netflix-like) — overrides only (does not touch rest of app) === */
#twitflix-modal .tf-modal-content{ max-width: 1400px; }

#twitflix-modal .tf-topbar{ position: sticky; top:0; z-index: 60; }
#twitflix-modal .tf-actions{ gap: 12px; }
#twitflix-modal .tf-search{ font-size: 14px; padding: 12px 14px 12px 38px; }

#twitflix-modal .tf-body{
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* Conteneur de contenu (ne scroll plus lui-même, le scroll est sur .tf-body) */
#twitflix-modal .tf-grid{
  display:flex;
  flex-direction: column;
  gap: 18px;
  padding: 14px 18px 24px 18px;
  flex: 0 0 auto;
  min-height: auto;
  overflow: visible;
}

#twitflix-modal .tf-hero{
  position: relative;
  height: 220px;
  border-radius: 14px;
  overflow:hidden;
  border:1px solid #1f1f23;
  background: #0a0a0a;
}
#twitflix-modal .tf-hero::before{
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(circle at 30% 20%, rgba(0,242,234,.18), transparent 60%),
              radial-gradient(circle at 80% 30%, rgba(255,0,153,.14), transparent 55%),
              linear-gradient(to top, rgba(0,0,0,.92), rgba(0,0,0,.20));
  z-index:2;
}
#twitflix-modal .tf-hero-bg{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit: cover;
  filter: saturate(1.05) contrast(1.05);
  opacity:.55;
}
#twitflix-modal .tf-hero-content{
  position:absolute; inset:0;
  z-index:3;
  display:flex;
  align-items:flex-end;
  padding: 18px;
}
#twitflix-modal .tf-hero-title{
  font-family: Arial Black, Impact, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  letter-spacing: .02em;
  font-size: 44px;
  font-weight: 900;
  color:#e50914;
  line-height: 1;
  text-transform: uppercase;
  text-shadow: 0 10px 30px rgba(0,0,0,.85);
}
#twitflix-modal .tf-hero-sub{
  margin-top: 6px;
  font-size: 12px;
  color:#cfcfda;
  max-width: 70ch;
  line-height: 1.35;
}

#twitflix-modal .tf-row{ display:flex; flex-direction:column; gap: 10px; }
#twitflix-modal .tf-row-title{
  font-family: Orbitron, sans-serif;
  letter-spacing: .14em;
  text-transform: uppercase;
  font-size: 12px;
  color:#eaeaf0;
  display:flex; align-items:center; justify-content:space-between;
}
#twitflix-modal .tf-row-title span{ color:#00f2ea; }
#twitflix-modal .tf-row-track{
  display:flex;
  gap: 16px;
  overflow-x:auto;
  padding-bottom: 10px;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling: touch;
}
#twitflix-modal .tf-row-track::-webkit-scrollbar{ height: 6px; }
#twitflix-modal .tf-row-track::-webkit-scrollbar-thumb{ background:#2a2a2f; border-radius:999px; }
#twitflix-modal .tf-row-track::-webkit-scrollbar-thumb:hover{ background:#00f2ea; }

#twitflix-modal .tf-card{
  flex: 0 0 170px;
  border-radius: 12px;
  overflow:hidden;
  background:#101013;
  border:1px solid #1d1d22;
  transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
}
#twitflix-modal .tf-card:hover{
  transform: scale(1.06);
  z-index: 40;
  border-color:#00f2ea;
  box-shadow: 0 18px 45px rgba(0,0,0,.55), 0 0 18px rgba(0,242,234,.18);
}
#twitflix-modal .tf-poster{
  width:100%; height:100%;
  object-fit: cover;
  transform: scale(1.02);
  opacity:.95;
}
#twitflix-modal .tf-card:hover .tf-poster{ opacity:.35; }

#twitflix-modal .tf-overlay{
  padding: 10px 10px 12px 10px;
}
#twitflix-modal .tf-name{
  font-size: 12px;
  font-weight: 900;
  white-space: nowrap;
  overflow:hidden;
  text-overflow: ellipsis;
}
#twitflix-modal .tf-meta{ display:none; } /* cache le texte “Survol…” */
#twitflix-modal .tf-actions-row{
  display:flex;
  gap:8px;
  justify-content:center;
  margin-top: 10px;
}
#twitflix-modal .tf-pill{
  display:inline-flex; align-items:center; gap:6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 900;
  color:#000;
  background:#00f2ea;
}
#twitflix-modal .tf-pill.ghost{
  background: rgba(255,255,255,.08);
  color:#e8e8ee;
  border:1px solid rgba(255,255,255,.14);
}

#twitflix-modal .tf-search-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 16px;
  padding-top: 10px;
}

#twitflix-modal .tf-azbar{
  position: sticky;
  top: 66px; /* sous la topbar */
  z-index: 55;
  display:flex;
  flex-wrap:wrap;
  gap: 6px;
  padding: 10px 0 8px 0;
  background: linear-gradient(180deg, rgba(11,11,13,.96), rgba(11,11,13,.72));
  border-bottom: 1px solid #1f1f23;
}
#twitflix-modal .tf-azlink{
  font-family: Orbitron, sans-serif;
  font-size: 10px;
  font-weight: 900;
  letter-spacing: .12em;
  color:#a7a7b2;
  text-decoration:none;
  padding: 6px 8px;
  border-radius: 10px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.12);
  transition:.2s;
}
#twitflix-modal .tf-azlink:hover{ color:#000; background:#00f2ea; border-color:#00f2ea; }

#twitflix-modal .tf-end{
  text-align:center;
  color:#9b9ba3;
  padding: 18px 0 6px 0;
}
#twitflix-modal .tf-retry{
  margin-top: 10px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid #2b2b31;
  background:#151515;
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
#twitflix-modal .tf-retry:hover{ border-color:#00f2ea; box-shadow:0 0 18px rgba(0,242,234,.18); transform: translateY(-1px); }


    /* HUB extras (emotes, gifs, réactions) */
    .hub-emo{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:#e8e8ee;
      padding:6px 10px;
      border-radius: 10px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
    }
    .hub-emo:hover{ border-color:#00f2ea; box-shadow:0 0 12px rgba(0,242,234,.15); }
    .hub-msg{
      padding:8px 10px;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .hub-badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-weight:900;
      font-size:10px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      margin-left:6px;
    }
    .hub-gif{
      margin-top:6px;
      border-radius: 12px;
      max-width: 260px;
      border:1px solid rgba(255,255,255,.10);
    }
    .hub-reactions{
      display:flex;
      gap:6px;
      margin-top:6px;
      flex-wrap:wrap;
      align-items:center;
    }
    .hub-react-btn{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color:#fff;
      font-size:12px;
      cursor:pointer;
    }
    .hub-react-btn:hover{ border-color:#00f2ea; }
    .hub-react-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color:#e8e8ee;
      font-size:12px;
    }



/* === EXTRAORDINAIRES (SAFE) === */
.hub-msg .hub-react-row{ opacity:0; max-height:0; overflow:hidden; transition: .18s ease; }
.hub-msg:hover .hub-react-row{ opacity:1; max-height:40px; }
.hub-msg.is-tapped .hub-react-row{ opacity:1; max-height:40px; }

.hub-gif{ max-width: 240px; border-radius: 10px; margin-top: 8px; border:1px solid rgba(255,255,255,.10); display:block; }

#ambilight{
  position:absolute; inset:-14px;
  filter: none;
  opacity:.55;
  z-index:0;
  pointer-events:none;
  transition: background .25s ease;
}
#player-wrap{ position:relative; }
#player-wrap > *{ position:relative; z-index:1; }

.mosaic-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  gap: 8px;
  width: 100%;
  height: 100%;
}
.mosaic-grid iframe{ width:100%; height:100%; border:0; border-radius:14px; }

.vibe-chill{ border:1px solid rgba(34,197,94,.55)!important; box-shadow: 0 0 0 1px rgba(34,197,94,.25) inset; }
.vibe-hype{ border:1px solid rgba(0,242,234,.70)!important; box-shadow: 0 0 0 1px rgba(0,242,234,.25) inset; }
.vibe-toxic{ border:1px solid rgba(239,68,68,.60)!important; box-shadow: 0 0 0 1px rgba(239,68,68,.22) inset; }


    /* ==== HUB Chat UX fixes ==== */
    #chat-container-hub { min-height: 520px; }
    #hub-messages { scroll-behavior: smooth; padding-bottom: 90px; }
    /* Keep input always visible */
    #chat-container-hub form { position: sticky; bottom: 0; z-index: 20; }

    /* Messenger-like reactions: hidden until hover/tap */
    .hub-react-row{ 
      opacity: 0; 
      max-height: 0; 
      overflow: hidden;
      pointer-events: none;
      transform: translateY(-4px);
      transition: opacity .15s ease, max-height .15s ease, transform .15s ease;
    }
    .hub-msg:hover .hub-react-row, .hub-msg.show-reactions .hub-react-row{
      opacity: 1;
      max-height: 44px;
      pointer-events: auto;
      transform: translateY(0);
    }
    .hub-react-btn{
      width: 34px; height: 34px;
      display:inline-flex; align-items:center; justify-content:center;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
    }
    .hub-react-btn:hover{ border-color:#00f2ea; }
    .hub-reactions{ display:flex; gap:6px; flex-wrap:wrap; margin-top:10px; }
    .hub-reaction-pill{
      display:inline-flex; align-items:center; gap:6px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    /* Ensure modules below player aren't clipped inside iframe */
    body { overflow-y: auto; }
    .page-wrap { padding-bottom: 40px; }


/* === Tools overlay (safe) === */

#player-tools{
  position:absolute;
  top:10px;
  right:10px;
  z-index:99999 !important;
  display:flex;
  gap:8px;
  pointer-events:auto;
}
#player-tools .toolbtn{ pointer-events:auto; }
#video-container iframe{ position:relative; z-index:1 !important; }
#video-container .player-wrap, #video-container #player{ position:relative; z-index:1 !important; }

#video-container{ position:relative; overflow: visible !important; }
.toolbtn{
  width:38px;height:34px;border-radius:12px;
  background:rgba(16,16,18,.86);
  border:1px solid rgba(255,255,255,.18);
  color:#fff;font-weight:900;cursor:pointer;
}
.toolbtn:hover{ border-color:#00f2ea; transform: translateY(-1px); }
.toolbtn.active{ border-color:#00f2ea; box-shadow:0 0 0 2px rgba(0,242,234,.22) inset; }

#ambilight{
  position:absolute; inset:-90px; z-index:0;
  filter: none;
  opacity:0;
  pointer-events:none;
  transition: opacity .2s ease;
}
#ambilight.on{ opacity:.78; }

#video-container iframe, #video-container .player-wrap, #video-container #player{ position:relative; z-index:2; }

/* Vibe borders */
.vibe-chill{ box-shadow: 0 0 0 2px rgba(0,242,234,.35) inset, 0 0 18px rgba(0,242,234,.18); }
.vibe-hype{ box-shadow: 0 0 0 2px rgba(255,0,153,.35) inset, 0 0 18px rgba(255,0,153,.18); }
.vibe-toxic{ box-shadow: 0 0 0 2px rgba(255,214,0,.35) inset, 0 0 18px rgba(255,214,0,.18); }

/* Modals (reuse if not already) */
.modal-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.75);
  display:none; align-items:center; justify-content:center;
  z-index:99999;
}
.modal-overlay.active{ display:flex; }
.modal-card{
  width:min(1100px,94vw);
  max-height:92vh;
  overflow:auto;
  background:#0b0b0d;
  border:1px solid rgba(255,255,255,.12);
  border-radius:18px;
  box-shadow: 0 0 40px rgba(0,0,0,.6);
  padding:14px;
}
.modal-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:6px 6px 12px; }
.modal-title{ font-family:Orbitron, sans-serif; letter-spacing:.12em; font-weight:900; font-size:12px; color:#eaeaf0; text-transform:uppercase; }
.modal-close{
  background:#151515; border:1px solid #2b2b31; color:#fff;
  width:36px; height:36px; border-radius:12px; cursor:pointer;
}
.modal-close:hover{ border-color:#00f2ea; }

.mosaic-grid{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; }
.mosaic-tile{ background:#000; border:1px solid rgba(255,255,255,.12); border-radius:14px; overflow:hidden; position:relative; aspect-ratio:16/9; }
.mosaic-tile button{
  position:absolute; top:10px; right:10px;
  background:rgba(0,0,0,.55);
  border:1px solid rgba(255,255,255,.18);
  color:#fff; border-radius:12px;
  padding:6px 10px; font-weight:900; cursor:pointer;
}
.mosaic-tile button:hover{ border-color:#00f2ea; }


/* === FORCE PLAYER + SIDE PANEL ALWAYS SIDE-BY-SIDE (embed-safe) === */
#main-layout{ 
      /* HARD FIX: force 2-column layout even if Tailwind is blocked by CSP */
      display: grid !important;
      grid-template-columns: minmax(0, 1fr) 420px;
      gap: 18px;
      align-items: stretch;
      min-height: 0;
    }
    /* Left column (player + top modules) */
    #main-layout > .col-span-8{ grid-column: 1 / 2; min-width: 0; }
    /* Right column (Chat/Stats/Tools) */
    #side-panel{ grid-column: 2 / 3; min-width: 320px; width: 100%; }
    /* Responsive: stack on small screens */
    @media (max-width: 1100px){
      #main-layout{ grid-template-columns: 1fr; }
      #main-layout > .col-span-8{ grid-column: 1 / -1; }
      #side-panel{ grid-column: 1 / -1; min-width: 0; }
    }
#main-layout > .col-span-8{ min-width: 640px; }
#side-panel{ min-width: 360px; max-width: 520px; }


/* === FIX: Sidebar chat should NOT deform Twitch player === */
#main-layout{ align-items: start !important; }
.player-shell{
  flex: 0 0 auto !important;
  height: clamp(520px, 72vh, 860px) !important;
  min-height: unset !important;
}
#video-container{
  flex: 1 1 auto !important;
  min-height: unset !important;
  height: 100% !important;
}


/* === FIX: side-panel height locked to player (Hub Secure can't stretch layout) === */
#side-panel{
  height: clamp(520px, 72vh, 860px) !important;
  min-height: 0 !important;
}
#tab-chat{
  min-height: 0 !important;
}
#chat-container-twitch,
#chat-container-hub{
  flex: 1 1 auto !important;
  min-height: 0 !important;
}
#hub-messages{
  min-height: 0 !important;
}

/* Ensure chat iframe can't force extra height */
#twitch-chat-frame{ display:block; width:100%; height:100%; }

/* === FIX: Messenger-like reactions (attached to message) without layout shift === */
.hub-msg{ position: relative !important; padding-bottom: 34px !important; }

/* Pills (existing reactions) stick to the bottom-right of the message */
.hub-reactions{
  position: absolute !important;
  right: 10px !important;
  bottom: 8px !important;
  margin: 0 !important;
  display: inline-flex !important;
  gap: 6px !important;
  flex-wrap: wrap !important;
  justify-content: flex-end !important;
  pointer-events: none !important;
}
/* Hide empty reactions container */
.hub-reactions:empty{ display:none !important; }

/* Reaction picker appears just above the pills, like Messenger */
.hub-react-row{
  position: absolute !important;
  right: 10px !important;
  bottom: 36px !important;
  opacity: 0 !important;
  pointer-events: none !important;
  transform: translateY(6px) !important;
  transition: opacity .15s ease, transform .15s ease !important;
  z-index: 5 !important;
}
.hub-msg:hover .hub-react-row,
.hub-msg.show-reactions .hub-react-row{
  opacity: 1 !important;
  pointer-events: auto !important;
  transform: translateY(0) !important;
}


/* HARD LAYOUT FIX: keep player left + side panel right even if Tailwind CDN/CSP fails */
#main-layout{
  display:grid !important;
  grid-template-columns:minmax(0,1fr) 420px !important;
  gap:16px !important;
  align-items:stretch !important;
  min-height:0 !important;
}
#main-layout > .col-span-8{ grid-column:1 !important; min-width:0 !important; }
#side-panel{ grid-column:2 !important; min-width:0 !important; height:100% !important; }
@media (max-width: 1100px){
  #main-layout{ grid-template-columns:1fr !important; }
  #side-panel{ grid-column:1 !important; }
}
/* Centered Market modal like ORYON TV */
#market-overlay .market-modal{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(1200px,96vw);
  height:min(88vh,900px);
  border-radius:18px;
  overflow:hidden;
}



    /* ====== HELP TOOLTIPS (❓) ====== */
    .help{
      cursor:pointer;
      margin-left:6px;
      color: rgba(180,200,255,.95);
      font-size: 13px;
      line-height: 1;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:18px;
      height:18px;
      border-radius:999px;
      border:1px solid rgba(180,200,255,.35);
      background: rgba(255,255,255,.04);
      position:relative;
      user-select:none;
    }
    .help:hover{
      background: rgba(180,200,255,.14);
      border-color: rgba(180,200,255,.55);
    }
    .help:hover::after{
      content: attr(data-help);
      position:absolute;
      left:0;
      top:26px;
      background: rgba(10,10,14,.96);
      color:#fff;
      padding:10px 12px;
      border-radius:10px;
      font-size:12px;
      width: 260px;
      z-index: 99999;
      box-shadow: 0 10px 24px rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.12);
      white-space: normal;
    }
    .help:hover::before{
      content:'';
      position:absolute;
      left:10px;
      top:20px;
      border:7px solid transparent;
      border-bottom-color: rgba(10,10,14,.96);
      z-index: 99999;
    }

    /* ====== ORYON TV HEADER CAROUSELS ====== */
    .tf-header-block{
      margin-top: 10px;
    }
    .tf-strip-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin: 8px 0 10px 2px;
    }
    .tf-strip-title h4{
      font-family: Orbitron, sans-serif;
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color:#eaeaf0;
      margin:0;
    }
    .tf-carousel{
      display:flex;
      gap:14px;
      overflow-x:auto;
      overflow-y:hidden;
      scroll-behavior:smooth;
      padding-bottom: 6px;
      min-height: 154px;
    }
    .tf-carousel::-webkit-scrollbar{ height: 8px; }
    .tf-carousel::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.12); border-radius:999px; }
    .tf-live-card{
      width: 250px;
      flex: 0 0 auto;
      border-radius: 14px;
      overflow:hidden;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      cursor:pointer;
      position:relative;
    }
    .tf-live-thumb{
      width: 100%;
      height: 140px;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    .tf-live-thumb .tf-preview{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.2);
    }
    .tf-live-meta{
      padding: 10px 12px 12px;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .tf-live-meta .t1{ font-weight: 800; font-size: 13px; color:#fff; }
    .tf-live-meta .t2{ font-size: 12px; color: rgba(255,255,255,.72); }
    .tf-live-badge{
      position:absolute;
      top:10px;
      left:10px;
      padding: 6px 8px;
      font-size: 11px;
      border-radius: 999px;
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.16);
      color: rgba(255,255,255,.92);
      backdrop-filter: none;
    }

    .tf-trailer-card{width: 440px;
      height: 248px; /* ~16:9 */
      flex: 0 0 auto;
      border-radius: 16px;
      overflow:hidden;
      background:#000;
      border: 1px solid rgba(255,255,255,.10);}
    .tf-trailer-card iframe{ width:100%; height:100%; border:0; display:block; }
    .tf-trailer-fallback{
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(255,255,255,.75);
      font-size: 12px;
      padding: 18px;
      text-align:center;
    }
    

#tf-trailer-carousel{min-height: 270px;}
#tf-live-carousel{min-height: 170px;}


/* Bigger close button top-right */
.tf-close-btn{
  margin-left: 10px;
  width: 46px;
  height: 46px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.35);
  color: #fff;
  font-size: 24px;
  font-weight: 900;
  line-height: 1;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.tf-close-btn:hover{ background: rgba(229,9,20,.22); border-color: rgba(229,9,20,.65); }

/* Keep the search + view toggle perfectly fixed and stable */
.tf-topbar{
  position: sticky;
  top: 0;
  z-index: 80;
  background: linear-gradient(180deg, rgba(11,11,13,.98), rgba(11,11,13,.86));
  backdrop-filter: none;
}
.tf-actions{ display:flex; align-items:center; gap: 10px; }
.tf-view-toggle{ flex: 0 0 auto; }

#tf-trailer-carousel{ gap: 16px; }
#tf-trailer-carousel .tf-trailer-card{ box-shadow: 0 10px 26px rgba(0,0,0,.45); }

/* === PAYWALL (robuste): sans blur + cadenas net === */
[data-paywall].paywall-scope{ position:relative !important; overflow:hidden !important; isolation:isolate; }
[data-paywall].paywall-scope[data-paywall-locked="1"]::before{
  content:"";
  position:absolute; inset:0;
  background: rgba(0,0,0,.55);
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  z-index: 1;
  pointer-events:none;
}
[data-paywall].paywall-scope[data-paywall-locked="1"] > :not(.paywall-inline-overlay){
  pointer-events:none !important;
  user-select:none !important;
}
.paywall-inline-overlay{
  position:absolute; inset:0;
  z-index: 2;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 14px;
  box-sizing:border-box;
  cursor:pointer;
}
.paywall-inline-card{
  width: min(520px, 100%);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 14px;
  background: rgba(10,10,10,.98);
  box-shadow: 0 20px 50px rgba(0,0,0,.45);
  padding: 14px 14px 12px;
  color: rgba(255,255,255,.92);
}
.paywall-inline-head{ display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px; }
.paywall-inline-head i{ font-size: 18px; color: #00f2ea; }
.paywall-inline-desc{ margin-top:8px; font-size:12px; line-height:1.35; color: rgba(255,255,255,.75); }
.paywall-inline-cta{ margin-top:10px; display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
.paywall-inline-cta a{
  display:inline-flex; align-items:center; gap:8px;
  padding: 9px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,242,234,.12);
  color: rgba(255,255,255,.92);
  text-decoration:none;
  font-weight:800;
  font-size: 12px;
}
.paywall-inline-cta small{ font-size:11px; color: rgba(255,255,255,.55); }

/* OUTILS padding (évite "collé au bord") */
#tab-tools{ padding: 14px 14px 24px !important; box-sizing:border-box; }
#tab-tools .tools-scroll, #tab-tools .panel-scroll{ padding: 10px 10px 18px !important; box-sizing:border-box; }


/* Compat badge (Steam ADN) */
#twitflix-modal .tf-compat-badge{
  position:absolute;
  top:10px; left:10px;
  z-index: 5;
  padding: 4px 9px;
  border-radius: 999px;
  background: rgba(0,0,0,.68);
  border: 1px solid rgba(255,255,255,.16);
  color:#00f2ea;
  font-size: 11px;
  font-weight: 900;
  letter-spacing: .02em;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

/* Steam button (ORYON TV topbar) */
#twitflix-modal .tf-steam-btn{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  white-space:nowrap;
  border-color: rgba(199,213,224,.18);
  background: rgba(17,17,19,.9);
}
#twitflix-modal .tf-steam-btn i{ color:#c7d5e0; font-size: 14px; }
#twitflix-modal .tf-steam-label{
  max-width: 160px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
#twitflix-modal #tf-btn-steam.tf-steam-connected{
  border-color: rgba(0,242,234,.32);
  box-shadow: 0 0 18px rgba(0,242,234,.10);
}
#twitflix-modal .tf-steam-check{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width: 18px;
  height: 18px;
  border-radius: 999px;
  background: rgba(0,242,234,.15);
  border: 1px solid rgba(0,242,234,.28);
  color:#00f2ea;
  font-weight: 900;
  font-size: 12px;
  line-height: 1;
}


/* === ORYON Big Picture (Steam-like) === */
body.tf-bigpicture { overflow: hidden; }
body.tf-bigpicture .tf-modal-overlay { background: radial-gradient(1200px 800px at 50% 20%, rgba(255,120,0,.08), rgba(0,0,0,.94)); }
body.tf-bigpicture #twitflix-modal .tf-modal-content{
  width: 100vw !important;
  height: 100vh !important;
  max-width: 100vw !important;
  max-height: 100vh !important;
  border-radius: 0 !important;
  margin: 0 !important;
}
body.tf-bigpicture #twitflix-modal .tf-topbar{
  padding: 18px 22px !important;
}
body.tf-bigpicture #twitflix-modal .tf-body{
  height: calc(100vh - 74px) !important;
  overflow: auto !important;
  scroll-behavior: smooth;
}
body.tf-bigpicture #twitflix-modal .tf-hero{ min-height: 360px; }
body.tf-bigpicture #twitflix-modal .tf-row-track{ gap: 18px; padding-bottom: 14px; }
body.tf-bigpicture #twitflix-modal .tf-card{ width: 220px; height: 330px; }
body.tf-bigpicture #twitflix-modal .tf-card .tf-name{ font-size: 14px; }
body.tf-bigpicture #twitflix-modal .tf-strip-title h4{ font-size: 18px; letter-spacing:.04em; }
body.tf-bigpicture #twitflix-modal .tf-search{ font-size: 14px; padding: 12px 40px 12px 40px; }
#twitflix-modal .tf-card{
  outline: none;
  user-select:none;
}
#twitflix-modal .tf-card:focus-visible,
#twitflix-modal .tf-card.tf-focused{
  box-shadow: 0 0 0 3px rgba(0,229,255,.95), 0 0 28px rgba(0,229,255,.35) !important;
  transform: translateY(-2px) scale(1.03);
}
body.tf-bigpicture #twitflix-modal .tf-card:focus-visible,
body.tf-bigpicture #twitflix-modal .tf-card.tf-focused{
  box-shadow: 0 0 0 3px rgba(255,140,0,.95), 0 0 32px rgba(255,140,0,.35) !important;
}
#twitflix-modal .tf-bp-btn{ display:inline-flex; align-items:center; gap:8px; }
#twitflix-modal .tf-bp-btn .tf-bp-label{ font-weight:800; letter-spacing:.06em; }

/* Transition overlay */
.tf-bp-transition{
  position: fixed; inset:0; z-index: 10050;
  display:none; align-items:center; justify-content:center;
  background: radial-gradient(800px 600px at 50% 30%, rgba(255,140,0,.18), rgba(0,0,0,.92));
}
.tf-bp-transition.active{ display:flex; animation: tfBpFade .42s ease both; }
@keyframes tfBpFade{ from{opacity:0;} to{opacity:1;} }
.tf-bp-vignette{
  position:absolute; inset:-2px;
  box-shadow: inset 0 0 260px rgba(0,0,0,.78);
  pointer-events:none;
}
.tf-bp-logo{
  font-family: Inter, sans-serif;
  font-weight: 900;
  letter-spacing: .20em;
  font-size: 22px;
  color: #ff8c00;
  text-transform: uppercase;
  text-shadow: 0 14px 40px rgba(0,0,0,.65);
  transform: translateY(8px) scale(.98);
  animation: tfBpPop .42s cubic-bezier(.2,.9,.2,1) both;
}
@keyframes tfBpPop{ from{opacity:0; transform: translateY(12px) scale(.96);} to{opacity:1; transform: translateY(0) scale(1);} }

/* === ORYON Big Picture: full-bleed + Netflix-like snap === */
body.tf-bigpicture #twitflix-modal{
  width: 100vw !important;
  max-width: 100vw !important;
  height: 100vh !important;
  max-height: 100vh !important;
  margin: 0 !important;
  border-radius: 0 !important;
  left: 0 !important; right: 0 !important; top: 0 !important; bottom: 0 !important;
}
body.tf-bigpicture #twitflix-modal .twitflix-inner{
  width: 100% !important;
  max-width: 100% !important;
}
body.tf-bigpicture #twitflix-modal .tf-row-track{
  scroll-snap-type: x mandatory;
  scroll-padding-left: 22px;
}
body.tf-bigpicture #twitflix-modal .tf-card{
  scroll-snap-align: start;
}
body.tf-bigpicture #twitflix-modal .tf-row-track::-webkit-scrollbar{ height: 10px; }
body.tf-bigpicture #twitflix-modal .tf-row-track::-webkit-scrollbar-thumb{ background: rgba(255,140,0,.25); border-radius: 999px; }
body.tf-bigpicture #twitflix-modal .tf-row-track::-webkit-scrollbar-track{ background: rgba(255,255,255,.06); border-radius: 999px; }


/* Fix: allow clicks through header logo */
.oryon-logo, .brand img, .logo img { pointer-events: none; }


/* ORYON TV row paging dots */
#twitflix-modal .tf-row-head{ display:flex; align-items:flex-end; justify-content:space-between; gap:14px; }
#twitflix-modal .tf-row-dots{ display:flex; gap:6px; align-items:center; justify-content:flex-end; padding-bottom:2px; }
#twitflix-modal .tf-dot{ width:7px; height:7px; border-radius:999px; background:rgba(255,255,255,.22); }
#twitflix-modal .tf-dot.active{ background: rgba(255,140,0,.92); box-shadow: 0 0 12px rgba(255,140,0,.35); }
#twitflix-modal .tf-row-track{ scroll-snap-type: x mandatory; scroll-behavior:smooth; }
#twitflix-modal .tf-card{ scroll-snap-align: start; }

</style>

<style id="tabs-exclusive-patch">
  /* --- Tabs exclusive patch (anti empilement) --- */
  #side-panel{ display:flex !important; flex-direction:column !important; min-height:0 !important; }
  #side-panel .tab-nav{ flex:0 0 auto !important; }
  #tabs-viewport{ flex:1 1 auto !important; position:relative !important; min-height:0 !important; background:#0b0b0d; }
  #tabs-viewport .tab-content{
    position:absolute !important; inset:0 !important;
    display:none !important;
    flex-direction:column !important;
    height:100% !important;
    min-height:0 !important;
  }
  #tabs-viewport .tab-content.active{ display:flex !important; }
  /* assure un scroll interne */
  #tabs-viewport .tools-scroll,
  #tabs-viewport .stats-scroll,
  #tabs-viewport #chat-container-twitch,
  #tabs-viewport #chat-container-hub{
    flex:1 1 auto !important;
    min-height:0 !important;
    overflow:auto !important;
  }
  /* si un wrapper chat existe, on le force à prendre la place */
  #tabs-viewport #tab-chat{ min-height:0 !important; }
</style>


<style id="tools-padding-fix">#tab-tools .tools-scroll{padding:16px 14px !important;}</style>
</head>
<body class="min-h-screen flex flex-col p-4">
<!-- Spacer (embed-safe): évite que le haut soit coupé dans certains iframes -->
<div style="height:18px;"></div>
<header class="flex justify-between items-center mb-4 pb-2 border-b border-[#222]">
<div class="flex items-center gap-4">
<h1 class="text-2xl font-orbitron italic tracking-widest">
<span class="text-[#00f2ea]">STREAMER</span> HUB
        <span class="bg-[#222] text-[#ff0099] px-2 rounded text-xs ml-2 not-italic">PRO</span>
</h1>
<div class="text-[10px] font-bold text-red-500 border border-red-500 px-2 rounded" id="socket-status">
        HUB DISCONNECTED
      </div>
</div>
<div class="flex items-center gap-3">
<button class="bg-[#111] hover:bg-[#222] text-white px-4 py-2 rounded font-bold transition flex items-center gap-2 text-xs font-orbitron border border-[#333] shadow-[0_0_10px_rgba(229,9,20,0.10)] twitflix-btn" onclick="openTwitFlix()">
<i class="fas fa-play-circle" style="color:#e50914"></i> <span class="twitflix-wordmark">ORYON TV</span>
      </button>
<button class="bg-[#111] hover:bg-[#161616] border border-[#00f2ea33] text-[#00f2ea] px-4 py-2 rounded font-bold transition flex items-center gap-2" onclick="openMarketOverlay()">
<i class="fas fa-chart-line"></i> MARCHÉ
      </button>
<div class="h-6 w-[1px] bg-[#333]"></div>
<button class="bg-[#6441a5] hover:bg-[#7d5bbe] text-white px-5 py-2 rounded font-bold transition flex items-center gap-2 text-xs font-orbitron border border-[#7d5bbe]" id="btn-auth" onclick="startAuth()">
<i class="fab fa-twitch"></i> CONNEXION
      </button>
<div class="hidden flex items-center gap-3" id="user-area">
<img class="w-8 h-8 rounded-full border border-[#00f2ea]" id="user-avatar" src=""/>
<span class="font-bold text-white text-sm" id="user-name"></span>

<!-- Espace utilisateur (crédits + accès Premium) -->
<!-- Espace utilisateur (crédits + accès Premium) -->
<div id="billing-menu-wrap" class="hidden relative">
  <button id="billing-link" class="bg-[#111] hover:bg-[#161616] border border-[#333] text-white px-3 py-1.5 rounded font-bold transition text-[11px] inline-flex items-center gap-2" title="Plan, crédits & portefeuille">
    <span class="text-gray-400">Crédits:</span> <span id="billing-credits" class="text-[#00f2ea]">—</span>
    <span id="billing-plan" class="ml-1 text-[10px] text-gray-400">FREE</span>
    <i class="fas fa-chevron-down text-[10px] text-gray-500"></i>
  </button>

  <div id="billing-menu" class="hidden absolute right-0 mt-2 w-[320px] bg-[#0b0b0d] border border-[#222] rounded-xl shadow-[0_18px_60px_rgba(0,0,0,.65)] z-[999] overflow-hidden">
    <div class="p-3 border-b border-[#222]">
      <div class="text-[11px] text-gray-400 uppercase font-bold">Plan & crédits</div>
      <div class="mt-1 flex items-center justify-between">
        <div class="text-sm font-bold text-white"><span id="billing-plan-2">FREE</span></div>
        <div class="text-sm font-bold"><span class="text-gray-400">Crédits</span> <span id="billing-credits-2" class="text-[#00f2ea]">—</span></div>
      </div>
      <div class="mt-2 flex gap-2">
        <a href="/pricing" class="flex-1 text-center bg-[#00f2ea] text-black font-extrabold text-[12px] py-2 rounded-lg">Voir /pricing</a>
        <button id="goto-portfolio" class="flex-1 text-center bg-[#111] border border-[#333] text-white font-extrabold text-[12px] py-2 rounded-lg">Portefeuille</button>
      </div>
      <div class="mt-2 text-[11px] text-gray-500">Le Portefeuille Marché utilise les mêmes crédits que la Bourse.</div>
    </div>

    <div class="p-3">
      <div class="text-[11px] text-gray-400 uppercase font-bold mb-2">Portefeuille Marché (aperçu)</div>
      <div class="flex items-center justify-between">
        <div class="text-[11px] text-gray-500">Cash</div>
        <div class="text-sm font-extrabold text-white"><span id="pf-cash-top">—</span></div>
      </div>
      <div id="pf-top-holdings" class="mt-2 text-[11px] text-gray-300 space-y-1"></div>
      <button id="open-market-from-menu" class="mt-3 w-full bg-[#111] border border-[#00f2ea33] text-[#00f2ea] font-extrabold text-[12px] py-2 rounded-lg">
        <i class="fas fa-chart-line mr-2"></i> Ouvrir le Marché
      </button>
    </div>
  </div>
</div>
<button class="text-gray-500 hover:text-white" onclick="logout()">
<i class="fas fa-sign-out-alt"></i>
</button>
</div>
</div>
</header>
<div class="mb-4 relative group">
<div class="carousel-track" id="carousel">
<div class="w-full text-center py-10 border border-dashed border-[#333] rounded text-gray-500">
<i class="fas fa-satellite-dish mb-2"></i><br/>
        Connectez-vous pour voir vos chaînes.
      </div>
</div>
<div class="absolute top-0 right-0 h-full w-20 bg-gradient-to-l from-[#050505] to-transparent pointer-events-none"></div>
</div>
<div class="flex-grow grid grid-cols-12 gap-6 min-h-0 overflow-x-auto" id="main-layout">
<div class="col-span-8 flex flex-col gap-4 min-h-0" id="left-col">
<div class="glass-panel flex-grow relative overflow-hidden flex flex-col rounded-lg shadow-2xl player-shell">
<div class="bg-[#080808] p-3 flex justify-between items-center border-b border-[#222]">
<div class="flex items-center gap-3 flex-1 min-w-0">
<div class="w-2 h-2 bg-red-600 rounded-full animate-pulse shadow-[0_0_10px_red]"></div>
<span class="font-orbitron text-[#00f2ea] text-sm tracking-wider truncate" id="current-channel-display">OFFLINE</span>
<span class="text-[10px] bg-[#222] px-2 py-0.5 rounded text-gray-400 flex-shrink-0" id="player-mode-badge">AUTO</span>
<span class="text-[10px] text-[#ff0099] font-bold flex-shrink-0" id="viewer-count">0 viewers</span>
</div>
<div class="flex gap-2 flex-shrink-0">
<button class="bg-[#1a1a1a] hover:bg-[#333] text-white w-8 h-8 rounded flex items-center justify-center" onclick="cycle('prev')">
<i class="fas fa-chevron-left"></i>
</button>
<button class="bg-[#1a1a1a] hover:bg-[#333] text-white w-8 h-8 rounded flex items-center justify-center" onclick="cycle('next')">
<i class="fas fa-chevron-right"></i>
</button>
</div>
</div>
<div class="flex-grow bg-black relative w-full h-full overflow-hidden" id="video-container">
<div id="player-tools" style="position:absolute;top:10px;right:10px;z-index:20;display:flex;gap:8px;"><button class="toolbtn" id="tool-mosaic" onclick="openMosaic()">📺</button>
</div>
</div>
</div>
<div class="glass-panel rounded-lg overflow-hidden min-h-[360px]" data-paywall data-paywall-feature="dashboard_premium" data-paywall-title="Dashboard Premium" data-paywall-desc="Débloque les 3 onglets (Overview / Analytics Pro / Niche) pour suivre tes stats avancées.">
<div class="u-nav" id="under-tabs-nav">
<button class="u-tab-btn active" data-ut="overview"><i class="fas fa-bolt mr-1"></i> OVERVIEW</button>
<button class="u-tab-btn" data-ut="analytics"><i class="fas fa-chart-line mr-1"></i> ANALYTICS PRO</button>
<button class="u-tab-btn" data-ut="niche"><i class="fas fa-compass mr-1"></i> NICHE</button>
</div>
<div class="u-tab-panel active p-4 bg-[#0b0b0d]" id="under-overview">
<div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Growth Score</div>
<div class="text-2xl font-orbitron text-[#00f2ea]" id="kpi-growth-score">--</div>
<div class="text-[10px] text-gray-400 mt-1" id="kpi-growth-label">--</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Moy. viewers (30j)</div>
<div class="text-2xl font-orbitron text-white" id="kpi-avg">--</div>
<div class="text-[10px] text-gray-500 mt-1">données Firestore</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Pic viewers</div>
<div class="text-2xl font-orbitron text-white" id="kpi-peak">--</div>
<div class="text-[10px] text-gray-500 mt-1">sur période</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Croissance</div>
<div class="text-2xl font-orbitron text-[#ff0099]" id="kpi-growth">--</div>
<div class="text-[10px] text-gray-500 mt-1">début → fin</div>
</div>
</div>
<div class="mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4">
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase">
<i class="fas fa-bell mr-1"></i> Alertes automatiques
              </h4>
<div class="text-xs text-gray-400" id="alerts-box">—</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase">
<i class="fas fa-wave-square mr-1"></i> Courbe daily
              </h4>
<div class="h-44"><canvas id="chartChannelDaily"></canvas></div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222] lg:col-span-2">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase">
<i class="fas fa-magic mr-1"></i> IA – plan d’action
              </h4>
<button class="w-full bg-[#00f2ea] text-black py-2 rounded font-bold hover:bg-white text-xs font-orbitron" id="btn-ai-reco" onclick="loadAIReco()">
                ⚡ Générer des recommandations
              </button>
<div class="mt-3 text-xs text-gray-300 leading-relaxed max-h-48 overflow-y-auto bg-[#0a0a0a] border border-[#222] rounded p-2 hidden" id="ai-reco-box"></div>
</div>
</div>
</div>
<div class="u-tab-panel p-4 bg-[#0b0b0d]" id="under-analytics">
<div class="grid grid-cols-1 lg:grid-cols-3 gap-3">
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Volatilité</div>
<div class="text-2xl font-orbitron text-white" id="kpi-volatility">--</div>
<div class="text-[10px] text-gray-500 mt-1">plus bas = plus stable</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Heures / semaine (estim.)</div>
<div class="text-2xl font-orbitron text-white" id="kpi-hours">--</div>
<div class="text-[10px] text-gray-500 mt-1">basé sur snapshots</div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<div class="text-[10px] text-gray-500 uppercase">Échantillons</div>
<div class="text-2xl font-orbitron text-white" id="kpi-samples">--</div>
<div class="text-[10px] text-gray-500 mt-1">jours couverts</div>
</div>
</div>
<div class="mt-4 bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-flask mr-1"></i> Simulation</h4>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-2">
<input class="cyber-input" id="sim-hours" max="80" min="1" placeholder="Heures / semaine" type="number" value="12"/>
<button class="bg-[#ff0099] text-white px-4 rounded font-bold hover:bg-white hover:text-black transition font-orbitron text-xs" onclick="runSimulation()">
                SIMULER
              </button>
<div class="text-xs text-gray-300 flex items-center bg-[#0a0a0a] border border-[#222] rounded px-3" id="sim-result">--</div>
</div>
</div>
</div>


<!-- (removed) fantasy-dashboard-removed moved to top Plan & crédits menu -->
<div class="u-tab-panel p-4 bg-[#0b0b0d]" id="under-niche">
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-crosshairs mr-1"></i> Chaîne vs Jeu</h4>
<div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
<div>
<div class="text-[10px] text-gray-500 uppercase">Saturation</div>
<div class="text-xl font-orbitron text-[#00f2ea]" id="niche-sat">--</div>
</div>
<div>
<div class="text-[10px] text-gray-500 uppercase">Découvrabilité</div>
<div class="text-xl font-orbitron text-[#ff0099]" id="niche-discover">--</div>
</div>
<div>
<div class="text-[10px] text-gray-500 uppercase">Position</div>
<div class="text-xl font-orbitron text-white" id="niche-position">--</div>
</div>
<div>
<div class="text-[10px] text-gray-500 uppercase">Verdict</div>
<div class="text-xl font-orbitron text-white" id="niche-verdict">--</div>
</div>
</div>
<div class="mt-3 text-xs text-gray-300" id="niche-details">—</div>
</div>
<div class="mt-4 bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-fire mr-1"></i> Heatmap meilleures heures (jeu)</h4>
<div class="h-44"><canvas id="chartGameHours"></canvas></div>
<div class="text-[10px] text-gray-500 mt-2">Plus haut = plus d’opportunité (viewers / concurrence).</div>
</div>
</div>
<div class="col-span-4 flex flex-col glass-panel rounded-lg overflow-hidden h-full min-h-0" id="side-panel">
<div class="tab-nav">
<button class="tab-btn active" onclick="openTab(event,'chat')"><i class="fas fa-comments mr-1"></i> CHAT</button>
<button class="tab-btn" onclick="openTab(event,'stats')"><i class="fas fa-chart-pie mr-1"></i> STATS</button>
<button class="tab-btn" onclick="openTab(event,'tools')"><i class="fas fa-toolbox mr-1"></i> OUTILS</button>
</div>
<div class="tab-content active bg-[#0e0e10]" id="tab-chat">
<div class="flex p-2 gap-2 bg-[#080808] border-b border-[#222] chat-mode-bar">
<button class="flex-1 py-1 text-xs font-bold bg-[#6441a5] text-white rounded" id="btn-mode-twitch" onclick="toggleChatMode('twitch')">TWITCH</button>
<button class="flex-1 py-1 text-xs font-bold bg-[#1a1a1a] text-gray-400 rounded hover:text-white" id="btn-mode-hub" onclick="toggleChatMode('hub')">HUB SECURE</button>
</div>
<div class="flex-grow relative bg-black overflow-hidden" id="chat-container-twitch">
<iframe allow="autoplay" frameborder="0" height="100%" id="twitch-chat-frame" scrolling="yes" src="" width="100%"></iframe>
</div>
<div class="flex-grow hidden flex-col relative bg-[#0b0b0d]" id="chat-container-hub">
<div class="flex-grow overflow-y-auto p-2 scrollbar-thin" id="hub-messages">
<div class="text-center text-gray-600 text-xs mt-4">
              Bienvenue sur le Hub Sécurisé — Connecté en tant que : <span class="text-[#00f2ea] font-bold" id="hub-user-display">Anonyme</span>
</div>
</div>
<form class="p-2 border-t border-[#222] flex gap-2 bg-[#080808] items-center" onsubmit="sendHubMessage(event)">
<button class="px-2 py-2 rounded-lg border border-[#333] text-gray-200 hover:border-[#00f2ea]" id="hub-emoji-btn" title="Emotes" type="button">🙂</button>
<button class="px-2 py-2 rounded-lg border border-[#333] text-gray-200 hover:border-[#00f2ea]" id="hub-gif-btn" title="GIF" type="button">🎁</button>
<input class="bg-[#0b0b0d] text-white px-3 py-2 rounded-lg flex-grow outline-none border border-[#333] focus:border-[#00f2ea]" id="hub-input" placeholder="Message / /gif / stickers..." type="text"/>
<button class="text-[#0b0b0d] bg-[#00f2ea] px-4 py-2 rounded-lg font-black hover:opacity-90" type="submit">Envoyer</button>
</form>
<div class="hidden absolute bottom-14 left-2 z-50 bg-[#0b0b0d] border border-[#222] rounded-xl p-2 shadow-2xl" id="hub-emoji-panel">
<div class="flex flex-wrap gap-2 text-sm">
<button class="hub-emo" type="button">:kappa:</button>
<button class="hub-emo" type="button">:pog:</button>
<button class="hub-emo" type="button">:gg:</button>
<button class="hub-emo" type="button">:love:</button>
<button class="hub-emo" type="button">:hype:</button>
<button class="hub-emo" type="button">:rip:</button>
<button class="hub-emo" type="button">:clap:</button>
<button class="hub-emo" type="button">:fire:</button>
</div>
<div class="text-[10px] text-gray-500 mt-2">Clique pour insérer dans ton message.</div>
</div>
<div class="hidden fixed inset-0 z-[9999] bg-black/70" id="hub-gif-modal">
<div class="max-w-3xl w-[92%] mx-auto mt-10 bg-[#0b0b0d] border border-[#222] rounded-2xl overflow-hidden shadow-2xl">
<div class="p-3 flex items-center gap-2 border-b border-[#222]">
<div class="font-black text-white tracking-widest">GIF</div>
<input class="flex-grow bg-[#070708] text-white px-3 py-2 rounded-lg border border-[#222] focus:border-[#00f2ea] outline-none" id="hub-gif-search" placeholder="Rechercher un GIF..."/>
<button class="px-3 py-2 rounded-lg border border-[#222] text-white hover:border-[#00f2ea]" id="hub-gif-close">Fermer</button>
</div>
<div class="p-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 max-h-[70vh] overflow-y-auto" id="hub-gif-grid"></div>
</div>
</div>
</div>
</div>
<div class="tab-content overflow-y-auto p-4 bg-[#0b0b0d] scrollbar-thin" id="tab-stats">
<div class="grid grid-cols-2 gap-3 mb-6">
<div class="bg-[#151515] p-3 rounded border-l-2 border-[#00f2ea]">
<div class="text-[10px] text-gray-500 uppercase">Viewers Totaux</div>
<div class="text-2xl font-orbitron text-white" id="kpi-viewers">--</div>
</div>
<div class="bg-[#151515] p-3 rounded border-l-2 border-[#ff0099]">
<div class="text-[10px] text-gray-500 uppercase">Chaînes FR</div>
<div class="text-2xl font-orbitron text-white" id="kpi-channels">--</div>
</div>
</div>
<div class="space-y-6">
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-chart-line mr-1"></i> Tendance</h4>
<div class="h-40"><canvas id="chartViewers"></canvas></div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-gamepad mr-1"></i> Top Jeux</h4>
<div class="h-48"><canvas id="chartGames"></canvas></div>
</div>
<div class="bg-[#111] p-3 rounded border border-[#222]">
<h4 class="text-xs text-gray-400 mb-2 font-bold uppercase"><i class="fas fa-globe mr-1"></i> Langues</h4>
<div class="h-40"><canvas id="chartLangs"></canvas></div>
</div>
</div>
</div>
<div class="tab-content bg-[#0b0b0d]" id="tab-tools"><div class="tools-scroll p-4 space-y-6 scrollbar-thin">
<div class="best-time-tool" data-paywall data-paywall-feature="best_time" data-paywall-title="Best Time to Stream" data-paywall-desc="Prédit les meilleurs horaires selon le jeu, tendances et audiences.">
<h4>🎯 BEST TIME TO STREAM</h4>
<input id="best-time-game" placeholder="Jeu ex: League of Legends..." type="text"/>
<button id="analyze-schedule-btn" onclick="analyzeBestTime()"><i class="fas fa-clock"></i> ANALYSER</button>
<div id="best-time-loading" style="display:none; text-align:center; margin-top:10px; color:#00f2ea;">
<span class="best-time-spinner"></span>Analyse en cours...
          </div>
<div class="best-time-results" id="best-time-results" style="display:none;"></div>
</div>
<div class="scanner-tool">
<h3 class="text-[#00f2ea] font-orbitron text-sm mb-3 border-b border-[#222] pb-2">SCANNER IA</h3>
<div class="flex gap-2 mb-3">
<input class="cyber-input" id="scan-query" placeholder="Pseudo ex: ZeratoR" type="text"/>
<button class="bg-[#00f2ea] text-black px-4 rounded font-bold hover:bg-white" onclick="runScan()">
<i class="fas fa-search"></i>
</button>
</div>
<div class="hidden bg-[#151515] p-3 rounded border border-[#222]" id="scan-res">
<div class="flex gap-3 items-center mb-3">
<img class="w-12 h-12 rounded-full border border-[#00f2ea]" id="scan-img" src=""/>
<div>
<div class="font-bold text-white" id="scan-name">--</div>
<div class="text-xs text-gray-500" id="scan-game">--</div>
</div>
</div>
<div class="text-xs text-gray-300 leading-relaxed max-h-40 overflow-y-auto" id="scan-ai"></div>
</div>
</div>

</div>
<div>
<h3 class="text-[#00f2ea] font-orbitron text-sm mb-3 border-b border-[#222] pb-2">RAID FINDER</h3>
<div class="flex gap-2 mb-3">
<input class="cyber-input" id="raid-game" placeholder="Jeu ex: League" type="text"/>
<input class="cyber-input" id="raid-viewers" placeholder="Max viewers" type="number" value="100"/>
</div>
<button class="w-full bg-[#00f2ea] text-black py-2 rounded font-bold hover:bg-white mb-3" onclick="runRaid()">🔍 CHERCHER</button>
<div class="hidden bg-[#151515] p-3 rounded border border-[#222]" id="raid-res">
<img class="w-full h-40 rounded mb-3 object-cover" id="raid-img" src=""/>
<div class="text-xs text-gray-300" id="raid-info"></div>
<button class="w-full bg-[#00f2ea] text-black py-2 rounded font-bold mt-2 hover:bg-white" id="raid-btn" onclick="goToRaid()">🎮 ALLER AU RAID</button>
</div>
</div>
<div data-paywall data-paywall-feature="costream_match" data-paywall-title="Co‑Stream Match" data-paywall-desc="Trouve un co‑streamer compatible (jeu / langue / taille).">
<h3 class="text-[#00f2ea] font-orbitron text-sm mb-3 border-b border-[#222] pb-2">CO-STREAM MATCH</h3>
<div class="text-xs text-gray-400 mb-2">Trouve un co-streamer compatible (jeu/langue/taille).</div>
<button class="w-full bg-[#00f2ea] text-black py-2 rounded font-bold hover:bg-white text-xs font-orbitron" id="costream-btn" onclick="loadCoStreamer()">
            🤝 TROUVER
          </button>
<div class="mt-3 bg-[#151515] p-3 rounded border border-[#222]" id="costream-out" style="display:none;"></div>
</div>
<div>
<h3 class="text-[#ff0099] font-orbitron text-sm mb-3 border-b border-[#222] pb-2">BOOST</h3>
<input class="cyber-input mb-2" id="boost-query" placeholder="Chaîne..." type="text"/>
<button class="w-full bg-[#ff0099] text-white py-2 rounded font-bold font-orbitron hover:bg-white hover:text-black transition" onclick="runBoost()">ACTIVER</button>
<div class="text-center text-xs mt-2 text-green-400" id="boost-msg"></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="tf-modal-overlay" id="twitflix-modal">
<div class="tf-modal-content">
<div class="tf-topbar">
<div class="tf-brand" style="cursor:pointer;" onclick="openTwitFlix()"><span class="tf-logo">ORYON TV</span></div>
<div class="tf-actions">
<div class="tf-search-wrap">
<i class="fas fa-search tf-search-ico"></i>
<input autocomplete="off" class="tf-search" id="twitflix-search" placeholder="Décris ce que tu veux (ex: \"comme Zomboid mais plus de craft et moins de stress\")" type="text"/>
</div>
<button class="tf-toggle-btn tf-steam-btn" id="tf-btn-steam" type="button" onclick="tfPromptSteam()">
  <i class="fab fa-steam" aria-hidden="true"></i>
  <span class="tf-steam-label">Connecter Steam</span>
</button>
<div class="tf-menu">
  <button class="tf-menu-btn" type="button" aria-label="Menu ORYON" onclick="tfToggleMenu(event)">☰</button>
  <div class="tf-menu-panel" id="tf-menu-panel" style="display:none;">
    <button type="button" onclick="closeTwitFlix(); tfHideMenu();">Fermer ORYON TV</button>
    <button type="button" onclick="tfQuitApp()">Quitter l’application</button>
  </div>
</div>

<button class="tf-close-btn" type="button" aria-label="Fermer ORYON TV" onclick="closeTwitFlix()">✕</button>
</div>
</div>
<div class="tf-sub" style="display:none;"></div>
<div class="tf-body" id="tf-body">
<div class="tf-hero"><img alt="" class="tf-hero-bg" id="tf-hero-bg" src=""/><div class="tf-hero-content"><div><div class="tf-hero-title" id="tf-hero-title">ORYON TV</div><div class="tf-hero-sub" id="tf-hero-sub">Découvre des jeux, survole pour une preview, clique pour lancer un stream.</div></div></div></div>

<div class="tf-header-block">
  <div class="tf-strip-title">
    <h4>Lives en cours <span class="help" data-help="Survole une carte pour une preview. Clique pour lancer un live correspondant au jeu.">?</span></h4>
  </div>
  <div class="tf-carousel" id="tf-live-carousel" aria-label="Lives en cours"></div>
</div>

<div class="tf-header-block">
  <div class="tf-strip-title">
    <h4>Trailers jeux vidéo <span class="help" data-help="Trailers intégrés (YouTube). Si un trailer manque, ORYON TV tente une recherche automatique.">?</span></h4>
  </div>
  <div class="tf-carousel" id="tf-trailer-carousel" aria-label="Trailers jeux vidéo"></div>
</div>

<div class="tf-grid" id="twitflix-grid">
<div class="text-center w-full text-gray-500 py-20" id="tf-loading">
<i class="fas fa-spinner fa-spin"></i> Chargement du catalogue...
        </div>
</div>
</div>
</div>
</div></div>
<div class="tf-bp-transition" id="tf-bp-transition" aria-hidden="true"><div class="tf-bp-vignette"></div><div class="tf-bp-logo"><img src="assets/img/oryon-logo.png" alt="ORYON" class="oryon-logo" style="height:22px;width:22px;border-radius:7px;margin-right:10px;vertical-align:-4px;pointer-events:none;">ORYON</div></div>
<script src="/assets/js/core/app-bootstrap.js?v=1770489680" defer></script>
<div class="modal-overlay" id="mosaicModal" onclick="closeMosaic(event)">
<div class="modal-card" onclick="event.stopPropagation()">
<div class="modal-head">
<div class="modal-title">Mosaic Mode</div>
<button class="modal-close" onclick="closeMosaic(event)">✕</button>
</div>
<div class="mosaic-grid" id="mosaicGrid"></div>
</div>
</div>
</div>
</div>
<!-- MARKET OVERLAY (center modal, Binance-like) -->
<div id="market-overlay" class="fixed inset-0 z-[9999] hidden" aria-hidden="true">
  <div class="absolute inset-0 bg-black/70" onclick="closeMarketOverlay()"></div>

  <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[min(1240px,96vw)] h-[min(90vh,920px)] rounded-2xl border border-white/10 bg-[#050607] shadow-[0_0_80px_rgba(0,229,255,0.08)] flex flex-col overflow-hidden">
    <div class="flex items-center justify-between px-4 py-3 border-b border-white/10">
      <div class="flex items-center gap-3">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-white/10 bg-white/5">
          <span class="inline-block w-2 h-2 rounded-full bg-[#00ff88] shadow-[0_0_12px_rgba(0,255,136,0.65)] animate-pulse"></span>
          <span class="text-xs font-bold tracking-wide">LIVE</span>
        </div>
        <div>
          <div class="text-lg font-extrabold tracking-tight">Marché des Streamers</div>
          <div class="text-xs text-white/60">Cours réels = viewers live (base) × impact (offre/demande). Aucune donnée inventée.</div>
        </div>
      </div>

      <div class="flex items-center gap-2">
        <button id="mkt-refresh" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Rafraîchir</button>
        <button id="mkt-auto" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Auto: ON</button>
        <button class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" onclick="closeMarketOverlay()">✕</button>
      </div>
    </div>

    <div class="flex items-center gap-2 px-4 py-2 border-b border-white/10">
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/10 text-sm font-bold" data-tab="overview">Overview</button>
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" data-tab="markets">Markets</button>
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" data-tab="chart">Chart Pro</button>
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" data-tab="portfolio">Portfolio</button>
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" data-tab="leaderboard">Classement</button>
      <button class="mkt-tab px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm" data-tab="learn">Comprendre</button>

      <div class="ml-auto flex items-center gap-2">
        <input id="mkt-search" placeholder="Rechercher un login Twitch (ex: zerator)" class="w-[min(420px,50vw)] px-3 py-2 rounded-lg bg-white/5 border border-white/10 outline-none text-sm" />
        <button id="mkt-add" class="px-3 py-2 rounded-lg bg-[#00e5ff] text-black font-bold text-sm">⭐ Ajouter</button>
      </div>
    </div>

    <div class="flex-1 overflow-hidden">
      <div class="h-full overflow-y-auto p-4" id="mkt-view">

        <!-- OVERVIEW -->
        <section id="mkt-tab-overview" class="mkt-view">
          <div class="grid grid-cols-12 gap-3">
            <div class="col-span-12 md:col-span-8 rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="flex items-start justify-between gap-3">
                <div>
                  <div class="text-xs text-white/60">Ticker sélectionné</div>
                  <div class="text-2xl font-extrabold tracking-tight" id="mkt-selected">—</div>
                </div>
                <div class="text-right">
                  <div class="text-xs text-white/60">Prix</div>
                  <div class="text-3xl font-extrabold tracking-tight" id="mkt-price">—</div>
                  <div class="text-xs" id="mkt-chg">—</div>
                </div>
              </div>

              <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Base (viewers)</div>
                  <div class="text-lg font-bold" id="mkt-base">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Impact (mult)</div>
                  <div class="text-lg font-bold" id="mkt-mult">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Shares</div>
                  <div class="text-lg font-bold" id="mkt-shares">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Market Cap</div>
                  <div class="text-lg font-bold" id="mkt-mcap">—</div>
                </div>
              </div>

              <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Perf 1h</div>
                  <div class="text-lg font-bold" id="mkt-p1h">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Perf 6h</div>
                  <div class="text-lg font-bold" id="mkt-p6h">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Perf 7j</div>
                  <div class="text-lg font-bold" id="mkt-p7d">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Trend Score</div>
                  <div class="text-lg font-bold" id="mkt-trend">—</div>
                </div>
              </div>

              <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">Volatilité</div>
                  <div class="text-lg font-bold" id="mkt-vol">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">High / Low (période)</div>
                  <div class="text-lg font-bold" id="mkt-hilo">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">SMA20 / SMA50</div>
                  <div class="text-lg font-bold" id="mkt-sma">—</div>
                </div>
                <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                  <div class="text-xs text-white/60">EMA20 / EMA50</div>
                  <div class="text-lg font-bold" id="mkt-ema">—</div>
                </div>
              </div>

              <div class="mt-4 flex flex-wrap items-center gap-2">
                <input id="mkt-amount" type="number" min="1" value="100" class="w-32 px-3 py-2 rounded-lg bg-white/5 border border-white/10 outline-none text-sm" />
                <button id="mkt-buy" class="px-4 py-2 rounded-lg bg-[#00ff88] text-black font-extrabold">Acheter</button>
                <button id="mkt-sell" class="px-4 py-2 rounded-lg bg-[#ff4d6d] text-black font-extrabold">Vendre</button>
                <div class="ml-auto text-xs text-white/60" id="mkt-updated">—</div>
              </div>
            </div>

            <div class="col-span-12 md:col-span-4 rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="flex items-center justify-between">
                <div class="font-extrabold">Heatmap Watchlist</div>
                <button id="mkt-edit" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Éditer</button>
              </div>
              <div class="text-xs text-white/60 mt-1">Basé sur Perf 1h (ou horizon sélectionné).</div>

              <div class="mt-3 flex items-center gap-2">
                <select id="mkt-horizon" class="px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-sm outline-none">
                  <option value="3600">1h</option>
                  <option value="21600">6h</option>
                  <option value="604800">7j</option>
                </select>
                <span class="text-xs text-white/60">Horizon</span>
              </div>

              <div class="mt-3 grid grid-cols-2 gap-2" id="mkt-heat"></div>

              <div class="mt-4 border-t border-white/10 pt-3">
                <div class="font-extrabold">Top Gainers / Losers</div>
                <div class="grid grid-cols-2 gap-2 mt-2">
                  <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                    <div class="text-xs text-white/60">Gainers</div>
                    <div id="mkt-gainers" class="text-sm mt-1"></div>
                  </div>
                  <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                    <div class="text-xs text-white/60">Losers</div>
                    <div id="mkt-losers" class="text-sm mt-1"></div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </section>

        <!-- MARKETS -->
        <section id="mkt-tab-markets" class="mkt-view hidden">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="flex flex-wrap items-center justify-between gap-2">
              <div class="font-extrabold text-lg">Markets (Watchlist)</div>
              <div class="flex items-center gap-2">
                <select id="mkt-sort" class="px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-sm outline-none">
                  <option value="trend">Trier: Trend</option>
                  <option value="p1h">Trier: Perf 1h</option>
                  <option value="p6h">Trier: Perf 6h</option>
                  <option value="p7d">Trier: Perf 7j</option>
                  <option value="mcap">Trier: Market Cap</option>
                  <option value="vol">Trier: Volatilité</option>
                </select>
                <button id="mkt-reload-watch" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Recharger</button>
              </div>
            </div>

            <div class="mt-3 overflow-x-auto">
              <table class="w-full text-sm">
                <thead class="text-white/60">
                  <tr>
                    <th class="text-left py-2">#</th>
                    <th class="text-left py-2">Streamer</th>
                    <th class="text-right py-2">Prix</th>
                    <th class="text-right py-2">1h</th>
                    <th class="text-right py-2">6h</th>
                    <th class="text-right py-2">7j</th>
                    <th class="text-right py-2">Vol</th>
                    <th class="text-right py-2">MCap</th>
                    <th class="text-right py-2">Trend</th>
                    <th class="text-right py-2">Spark</th>
                  </tr>
                </thead>
                <tbody id="mkt-table"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- CHART -->
        <section id="mkt-tab-chart" class="mkt-view hidden">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="flex flex-wrap items-center justify-between gap-2">
              <div>
                <div class="font-extrabold text-lg">Chart Pro</div>
                <div class="text-xs text-white/60">Sparklines + SMA/EMA (calculés sur l'historique renvoyé par /api/fantasy/market).</div>
              </div>
              <div class="flex items-center gap-2">
                <label class="text-xs text-white/60 flex items-center gap-2"><input id="mkt-toggle-sma" type="checkbox" checked> SMA</label>
                <label class="text-xs text-white/60 flex items-center gap-2"><input id="mkt-toggle-ema" type="checkbox" checked> EMA</label>
              </div>
            </div>

            <div class="mt-3 rounded-xl border border-white/10 bg-black/30 p-3">
              <svg id="mkt-chart" viewBox="0 0 1000 360" preserveAspectRatio="none" class="w-full h-[360px]"></svg>
              <div class="text-xs text-white/60 mt-2" id="mkt-chart-meta">—</div>
            </div>
          </div>
        </section>

        <!-- PORTFOLIO -->
        <section id="mkt-tab-portfolio" class="mkt-view hidden">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="flex flex-wrap items-center justify-between gap-2">
              <div class="font-extrabold text-lg">Portfolio</div>
              <div class="flex items-center gap-2">
                <input id="mkt-user" value="Anon" class="px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-sm outline-none" />
                <button id="mkt-load-portfolio" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Charger</button>
              </div>
            </div>

            <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
              <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                <div class="text-xs text-white/60">Cash</div>
                <div class="text-lg font-bold" id="pf-cash">—</div>
              </div>
              <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                <div class="text-xs text-white/60">Valeur positions</div>
                <div class="text-lg font-bold" id="pf-hold">—</div>
              </div>
              <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                <div class="text-xs text-white/60">Net Worth</div>
                <div class="text-lg font-bold" id="pf-net">—</div>
              </div>
              <div class="rounded-xl border border-white/10 bg-black/20 p-3">
                <div class="text-xs text-white/60">Positions</div>
                <div class="text-lg font-bold" id="pf-n">—</div>
              </div>
            </div>

            <div class="mt-3 overflow-x-auto">
              <table class="w-full text-sm">
                <thead class="text-white/60">
                  <tr>
                    <th class="text-left py-2">Streamer</th>
                    <th class="text-right py-2">Shares</th>
                    <th class="text-right py-2">Prix</th>
                    <th class="text-right py-2">Valeur</th>
                  </tr>
                </thead>
                <tbody id="pf-table"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- LEADERBOARD -->
        <section id="mkt-tab-leaderboard" class="mkt-view hidden">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="flex items-center justify-between">
              <div class="font-extrabold text-lg">Classement</div>
              <button id="mkt-load-leader" class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-sm">Charger</button>
            </div>
            <div class="mt-3" id="lb-list"></div>
          </div>
        </section>

        <!-- LEARN -->
        <section id="mkt-tab-learn" class="mkt-view hidden">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4 prose prose-invert max-w-none">
            <h3>Comment le prix est calculé (réel)</h3>
            <ul>
              <li><strong>BasePrice</strong> : dérivé des viewers live du streamer (si offline, base minimale).</li>
              <li><strong>SharesOutstanding</strong> : nombre total de “parts” en circulation (achats/ventes).</li>
              <li><strong>Impact</strong> : multiplicateur qui augmente avec la demande (logarithmique).</li>
              <li><strong>Prix final</strong> = BasePrice × Impact.</li>
            </ul>
            <p>Les performances (1h/6h/7j), SMA/EMA, volatilité et trend score sont calculés uniquement à partir de l’historique de prix renvoyé par l’API (<code>/api/fantasy/market</code>), donc sans données inventées.</p>
            <p><strong>Watchlist “Firebase” :</strong> au premier lancement, l’app construit une watchlist réelle à partir des holdings des meilleurs portefeuilles (endpoint leaderboard + profile). Les utilisateurs peuvent ensuite en ajouter.</p>
          </div>
        </section>

      </div>
    </div>
  </div>

  <!-- Edit Watchlist Modal -->
  <div id="mkt-edit-modal" class="fixed inset-0 z-[10000] hidden">
    <div class="absolute inset-0 bg-black/70" onclick="document.getElementById('mkt-edit-modal').classList.add('hidden')"></div>
    <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[min(760px,94vw)] rounded-2xl border border-white/10 bg-[#050607] p-4">
      <div class="flex items-center justify-between">
        <div class="font-extrabold text-lg">Watchlist</div>
        <button class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10" onclick="document.getElementById('mkt-edit-modal').classList.add('hidden')">✕</button>
      </div>
      <div class="text-xs text-white/60 mt-1">Sépare par des virgules. Exemple : <code>zerator, gotaga, kamet0</code></div>
      <textarea id="mkt-watchlist" class="mt-3 w-full h-32 px-3 py-2 rounded-lg bg-white/5 border border-white/10 outline-none text-sm"></textarea>
      <div class="mt-3 flex items-center justify-end gap-2">
        <button class="px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10" onclick="document.getElementById('mkt-edit-modal').classList.add('hidden')">Annuler</button>
        <button id="mkt-save-watchlist" class="px-3 py-2 rounded-lg bg-[#00e5ff] text-black font-extrabold">Enregistrer</button>
      </div>
    </div>
  </div>
</div>


<script src="/assets/js/modules/layout/sidepanel-dock-fix.js" defer></script>


<script src="/assets/js/modules/market/market-overlay.js" defer></script>



<script src="/assets/js/modules/ui/sidepanel-tabs.js" defer></script>


<script src="/assets/js/modules/ui/help-tooltips.js" defer></script>
</body>
</html>
